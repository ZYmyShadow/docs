<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>NMAP帮助文档 | 修仙藏书阁</title><meta name="keywords" content="tools,nmap"><meta name="author" content="ZYmyShadow"><meta name="copyright" content="ZYmyShadow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="官方帮助文档说明以及常用选项">
<meta property="og:type" content="article">
<meta property="og:title" content="NMAP帮助文档">
<meta property="og:url" content="http://zymyshadow.github.io/dfc73c11bf58/index.html">
<meta property="og:site_name" content="修仙藏书阁">
<meta property="og:description" content="官方帮助文档说明以及常用选项">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zymyshadow.github.io/img/nmap/sitelogo.png">
<meta property="article:published_time" content="2022-09-06T04:00:00.000Z">
<meta property="article:modified_time" content="2023-08-13T12:51:28.891Z">
<meta property="article:author" content="ZYmyShadow">
<meta property="article:tag" content="tools">
<meta property="article:tag" content="nmap">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zymyshadow.github.io/img/nmap/sitelogo.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://zymyshadow.github.io/dfc73c11bf58/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-5809221017203863',
  enable_page_level_ads: 'true'
});</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NMAP帮助文档',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-13 20:51:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/custom/twikoo_beautify.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/custom/fixed_comment.css"  media="defer" onload="this.media='all'"><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5809221017203863" crossorigin="anonymous"></script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/29786999?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图片</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于宗主</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/nmap/sitelogo.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">修仙藏书阁</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 图片</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于宗主</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">NMAP帮助文档</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-06T04:00:00.000Z" title="发表于 2022-09-06 12:00:00">2022-09-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-13T12:51:28.891Z" title="更新于 2023-08-13 20:51:28">2023-08-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/">工具集</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>58分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NMAP帮助文档"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/dfc73c11bf58/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="NMAP官方帮助说明"><a href="#NMAP官方帮助说明" class="headerlink" title="NMAP官方帮助说明"></a>NMAP官方帮助说明</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Usage: nmap [Scan Type(s)] [Options] &#123;target specification&#125;</span><br><span class="line">TARGET SPECIFICATION:</span><br><span class="line">  Can pass hostnames, IP addresses, networks, etc.</span><br><span class="line">  Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0-255.0-255.1-254</span><br><span class="line">  -iL &lt;inputfilename&gt;: Input from list of hosts/networks</span><br><span class="line">  -iR &lt;num hosts&gt;: Choose random targets</span><br><span class="line">  --exclude &lt;host1[,host2][,host3],...&gt;: Exclude hosts/networks</span><br><span class="line">  --excludefile &lt;exclude_file&gt;: Exclude list from file</span><br><span class="line">HOST DISCOVERY:</span><br><span class="line">  -sL: List Scan - simply list targets to scan</span><br><span class="line">  -sP: Ping Scan - go no further than determining <span class="keyword">if</span> host is online</span><br><span class="line">  -P0: Treat all hosts as online -- skip host discovery</span><br><span class="line">  -PS/PA/PU [portlist]: TCP SYN/ACK or UDP discovery probes to given ports</span><br><span class="line">  -PE/PP/PM: ICMP <span class="built_in">echo</span>, timestamp, and netmask request discovery probes</span><br><span class="line">  -n/-R: Never <span class="keyword">do</span> DNS resolution/Always resolve [default: sometimes resolve]</span><br><span class="line">SCAN TECHNIQUES:</span><br><span class="line">  -sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans</span><br><span class="line">  -sN/sF/sX: TCP Null, FIN, and Xmas scans</span><br><span class="line">  --scanflags &lt;flags&gt;: Customize TCP scan flags</span><br><span class="line">  -sI &lt;zombie host[:probeport]&gt;: Idlescan</span><br><span class="line">  -sO: IP protocol scan</span><br><span class="line">  -b &lt;ftp relay host&gt;: FTP bounce scan</span><br><span class="line">PORT SPECIFICATION AND SCAN ORDER:</span><br><span class="line">  -p &lt;port ranges&gt;: Only scan specified ports</span><br><span class="line">    Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080</span><br><span class="line">  -F: Fast - Scan only the ports listed <span class="keyword">in</span> the nmap-services file)</span><br><span class="line">  -r: Scan ports consecutively - don<span class="string">&#x27;t randomize</span></span><br><span class="line"><span class="string">SERVICE/VERSION DETECTION:</span></span><br><span class="line"><span class="string">  -sV: Probe open ports to determine service/version info</span></span><br><span class="line"><span class="string">  --version-light: Limit to most likely probes for faster identification</span></span><br><span class="line"><span class="string">  --version-all: Try every single probe for version detection</span></span><br><span class="line"><span class="string">  --version-trace: Show detailed version scan activity (for debugging)</span></span><br><span class="line"><span class="string">OS DETECTION:</span></span><br><span class="line"><span class="string">  -O: Enable OS detection</span></span><br><span class="line"><span class="string">  --osscan-limit: Limit OS detection to promising targets</span></span><br><span class="line"><span class="string">  --osscan-guess: Guess OS more aggressively</span></span><br><span class="line"><span class="string">TIMING AND PERFORMANCE:</span></span><br><span class="line"><span class="string">  -T[0-6]: Set timing template (higher is faster)</span></span><br><span class="line"><span class="string">  --min-hostgroup/max-hostgroup &lt;size&gt;: Parallel host scan group sizes</span></span><br><span class="line"><span class="string">  --min-parallelism/max-parallelism &lt;numprobes&gt;: Probe parallelization</span></span><br><span class="line"><span class="string">  --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;msec&gt;: Specifies</span></span><br><span class="line"><span class="string">      probe round trip time.</span></span><br><span class="line"><span class="string">  --host-timeout &lt;msec&gt;: Give up on target after this long</span></span><br><span class="line"><span class="string">  --scan-delay/--max-scan-delay &lt;msec&gt;: Adjust delay between probes</span></span><br><span class="line"><span class="string">FIREWALL/IDS EVASION AND SPOOFING:</span></span><br><span class="line"><span class="string">  -f; --mtu &lt;val&gt;: fragment packets (optionally w/given MTU)</span></span><br><span class="line"><span class="string">  -D &lt;decoy1,decoy2[,ME],...&gt;: Cloak a scan with decoys</span></span><br><span class="line"><span class="string">  -S &lt;IP_Address&gt;: Spoof source address</span></span><br><span class="line"><span class="string">  -e &lt;iface&gt;: Use specified interface</span></span><br><span class="line"><span class="string">  -g/--source-port &lt;portnum&gt;: Use given port number</span></span><br><span class="line"><span class="string">  --data-length &lt;num&gt;: Append random data to sent packets</span></span><br><span class="line"><span class="string">  --ttl &lt;val&gt;: Set IP time-to-live field</span></span><br><span class="line"><span class="string">  --spoof-mac &lt;mac address, prefix, or vendor name&gt;: Spoof your MAC address</span></span><br><span class="line"><span class="string">OUTPUT:</span></span><br><span class="line"><span class="string">  -oN/-oX/-oS/-oG &lt;file&gt;: Output scan results in normal, XML, s|&lt;rIpt kIddi3,</span></span><br><span class="line"><span class="string">     and Grepable format, respectively, to the given filename.</span></span><br><span class="line"><span class="string">  -oA &lt;basename&gt;: Output in the three major formats at once</span></span><br><span class="line"><span class="string">  -v: Increase verbosity level (use twice for more effect)</span></span><br><span class="line"><span class="string">  -d[level]: Set or increase debugging level (Up to 9 is meaningful)</span></span><br><span class="line"><span class="string">  --packet-trace: Show all packets sent and received</span></span><br><span class="line"><span class="string">  --iflist: Print host interfaces and routes (for debugging)</span></span><br><span class="line"><span class="string">  --append-output: Append to rather than clobber specified output files</span></span><br><span class="line"><span class="string">  --resume &lt;filename&gt;: Resume an aborted scan</span></span><br><span class="line"><span class="string">  --stylesheet &lt;path/URL&gt;: XSL stylesheet to transform XML output to HTML</span></span><br><span class="line"><span class="string">  --no-stylesheet: Prevent Nmap from associating XSL stylesheet w/XML output</span></span><br><span class="line"><span class="string">MISC:</span></span><br><span class="line"><span class="string">  -6: Enable IPv6 scanning</span></span><br><span class="line"><span class="string">  -A: Enables OS detection and Version detection</span></span><br><span class="line"><span class="string">  --datadir &lt;dirname&gt;: Specify custom Nmap data file location</span></span><br><span class="line"><span class="string">  --send-eth/--send-ip: Send packets using raw ethernet frames or IP packets</span></span><br><span class="line"><span class="string">  --privileged: Assume that the user is fully privileged</span></span><br><span class="line"><span class="string">  -V: Print version number</span></span><br><span class="line"><span class="string">  -h: Print this help summary page.</span></span><br><span class="line"><span class="string">EXAMPLES:</span></span><br><span class="line"><span class="string">  nmap -v -A scanme.nmap.org</span></span><br><span class="line"><span class="string">  nmap -v -sP 192.168.0.0/16 10.0.0.0/8</span></span><br><span class="line"><span class="string">  nmap -v -iR 10000 -P0 -p 80</span></span><br></pre></td></tr></table></figure>
<h1 id="NMAP常用选项"><a href="#NMAP常用选项" class="headerlink" title="NMAP常用选项"></a>NMAP常用选项</h1><hr>
<ul>
<li>-sL（List Scan 列表扫描，仅将指定的目标的IP列举出来，不进行主机发现）</li>
<li>-sn（Ping Scan 只进行主机发现，不进行端口扫描）</li>
<li>-Pn（将所有指定的主机当作是开启的，跳过主机发现的过程）</li>
<li>-PS/PA/PU/PY</li>
<li>-PE/PP/PM</li>
<li>-n/-R（不进行DNS解析/进行DNS解析）</li>
<li>—dns-servers（指定DNS服务器）</li>
<li>—system-dns（使用系统的DNS）</li>
<li>—traceroute（进行路由追踪）</li>
</ul>
<hr>
<h2 id="扫描存活主机"><a href="#扫描存活主机" class="headerlink" title="扫描存活主机"></a>扫描存活主机</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn 10.1.1.1-100</span><br></pre></td></tr></table></figure>
<h1 id="NMAP选项解析"><a href="#NMAP选项解析" class="headerlink" title="NMAP选项解析"></a>NMAP选项解析</h1><h2 id="目标说明"><a href="#目标说明" class="headerlink" title="目标说明"></a>目标说明</h2><p>NMap可以接收多个主机</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap scanme.nmap.org 192.168.0.0/8 10.0.0, 1, 3-7.0-255</span><br></pre></td></tr></table></figure>
<h3 id="iL-lt-inputfilename-gt-从列表中输入"><a href="#iL-lt-inputfilename-gt-从列表中输入" class="headerlink" title="-iL &lt;inputfilename&gt; (从列表中输入)"></a><code>-iL &lt;inputfilename&gt;</code> (从列表中输入)</h3><p>从<em><code>&lt;inputfilename&gt;</code></em> 中读取目标说明。在命令行输入 一堆主机名显得很笨拙，然而经常需要这样。 例如，您的DHCP服务器可能导出10,000个当前租约的列表，而您希望对它们进行 扫描。如果您<em>不是</em>使用未授权的静态IP来定位主机，或许您想要扫描所有IP地址。 只要生成要扫描的主机的列表，用<code>-iL</code> 把文件名作为选项传给Nmap。列表中的项可以是Nmap在 命令行上接受的任何格式(IP地址，主机名，CIDR，IPv6，或者八位字节范围)。 每一项必须以一个或多个空格，制表符或换行符分开。 如果您希望Nmap从标准输入而不是实际文件读取列表， 您可以用一个连字符(<code>-</code>)作为文件名。</p>
<h3 id="iR-lt-hostnum-gt-随机选择目标"><a href="#iR-lt-hostnum-gt-随机选择目标" class="headerlink" title="-iR &lt;hostnum&gt; (随机选择目标)"></a><code>-iR &lt;hostnum&gt;</code> (随机选择目标)</h3><p>对于互联网范围内的调查和研究， 您也许想随机地选择目标。 <em><code>&lt;hostnum&gt;</code></em> 选项告诉 Nmap生成多少个IP。不合需要的IP如特定的私有，组播或者未分配的地址自动 略过。选项 <code>0</code> 意味着永无休止的扫描。记住，一些网管对于未授权的扫描可能会很感冒并加以抱怨。 使用该选项的后果自负! 如果在某个雨天的下午，您觉得实在无聊， 试试这个命令<strong>nmap -sS -PS80 -iR 0 -p 80</strong>随机地找一些网站浏览。</p>
<h3 id="exclude-lt-host1-，host2-，host3-，-gt-排除主机-网络"><a href="#exclude-lt-host1-，host2-，host3-，-gt-排除主机-网络" class="headerlink" title="--exclude &lt;host1[，host2][，host3]，...&gt; (排除主机/网络)"></a><code>--exclude &lt;host1[，host2][，host3]，...&gt;</code> (排除主机/网络)</h3><p>如果在您指定的扫描范围有一些主机或网络不是您的目标， 那就用该选项加上以逗号分隔的列表排除它们。该列表用正常的Nmap语法， 因此它可以包括主机名，CIDR，八位字节范围等等。 当您希望扫描的网络包含执行关键任务的服务器，已知的对端口扫描反应强烈的 系统或者被其它人看管的子网时，这也许有用。</p>
<h3 id="excludefile-lt-excludefile-gt-排除文件中的列表"><a href="#excludefile-lt-excludefile-gt-排除文件中的列表" class="headerlink" title="--excludefile &lt;excludefile&gt; (排除文件中的列表)"></a><code>--excludefile &lt;excludefile&gt;</code> (排除文件中的列表)</h3><p>这和<code>--exclude</code> 选项的功能一样，只是所排除的目标是用以 换行符，空格，或者制表符分隔的 <em><code>&lt;excludefile&gt;</code></em>提供的，而不是在命令行上输入的。</p>
<hr>
<h2 id="主机发现"><a href="#主机发现" class="headerlink" title="主机发现"></a>主机发现</h2><p>普通的<code>ping</code>只是发送简单的ICMP回声请求报文，但是<code>Nmap</code>可以通过使用列表扫描<code>-sL</code>或者通过关闭ping<code>-P0</code>跳过ping的步骤，也可以使用多个端口把<code>TCP SYN/ACK，UDP</code>和<code>ICMP</code>任意组合起来玩一玩。</p>
<p>如果没有给出主机发现的选项，Nmap 就发送一个<code>TCP ACK</code>报文到80端口和一个ICMP回声请求到每台目标机器。 一个例外是ARP扫描用于局域网上的任何目标机器。对于非特权UNIX shell用户，使用<code>connect()</code>系统调用会发送一个SYN报文而不是ACK 这些默认行为和使用<code>-PA -PE</code>选项的效果相同。 扫描局域网时，这种主机发现一般够用了，但是对于安全审核，建议进行 更加全面的探测。</p>
<p><code>-P*</code>选项(用于选择 ping的类型)可以被结合使用。 您可以通过使用不同的TCP端口/标志位和ICMP码发送许多探测报文 来增加穿透防守严密的防火墙的机会。另外要注意的是即使您指定了其它 <code>-P*</code>选项，ARP发现(<code>-PR</code>)对于局域网上的 目标而言是默认行为，因为它总是更快更有效。</p>
<h3 id="sL-列表扫描"><a href="#sL-列表扫描" class="headerlink" title="-sL (列表扫描)"></a><code>-sL</code> (列表扫描)</h3><p>列表扫描是主机发现的退化形式，它仅仅列出指定网络上的每台主机， 不发送任何报文到目标主机。默认情况下，Nmap仍然对主机进行反向域名解析以获取 它们的名字。简单的主机名能给出的有用信息常常令人惊讶。例如， <code>fw.chi.playboy.com</code>是花花公子芝加哥办公室的 防火墙。Nmap最后还会报告IP地址的总数。列表扫描可以很好的确保您拥有正确的目标IP。 如果主机的域名出乎您的意料，那么就值得进一步检查以防错误地扫描其它组织的网络。</p>
<p>既然只是打印目标主机的列表，像其它一些高级功能如端口扫描，操作系统探测或者Ping扫描 的选项就没有了。如果您希望关闭ping扫描而仍然执行这样的高级功能，请继续阅读关于 <code>-P0</code>选项的介绍。</p>
<h3 id="sP-Ping扫描"><a href="#sP-Ping扫描" class="headerlink" title="-sP (Ping扫描)"></a><code>-sP</code> (Ping扫描)</h3><p>该选项告诉Nmap<em>仅仅</em> 进行ping扫描 (主机发现)，然后打印出对扫描做出响应的那些主机。 没有进一步的测试 (如端口扫描或者操作系统探测)。 这比列表扫描更积极，常常用于 和列表扫描相同的目的。它可以得到些许目标网络的信息而不被特别注意到。 对于攻击者来说，了解多少主机正在运行比列表扫描提供的一列IP和主机名往往更有价值。</p>
<p>系统管理员往往也很喜欢这个选项。 它可以很方便地得出 网络上有多少机器正在运行或者监视服务器是否正常运行。常常有人称它为 地毯式ping，它比ping广播地址更可靠，因为许多主机对广播请求不响应。</p>
<p><code>-sP</code>选项在默认情况下， 发送一个ICMP回声请求和一个TCP报文到80端口。如果非特权用户执行，就发送一个SYN报文 (用<code>connect()</code>系统调用)到目标机的80端口。 当特权用户扫描局域网上的目标机时，会发送ARP请求(<code>-PR</code>)， ，除非使用了<code>--send-ip</code>选项。 <code>-sP</code>选项可以和除<code>-P0</code>)之外的任何发现探测类型<code>-P*</code> 选项结合使用以达到更大的灵活性。 一旦使用了任何探测类型和端口选项，默认的探测(ACK和回应请求)就被覆盖了。 当防守严密的防火墙位于运行Nmap的源主机和目标网络之间时， 推荐使用那些高级选项。否则，当防火墙捕获并丢弃探测包或者响应包时，一些主机就不能被探测到。</p>
<h3 id="P0-无ping"><a href="#P0-无ping" class="headerlink" title="-P0 (无ping)"></a><code>-P0</code> (无ping)</h3><p>该选项完全跳过Nmap发现阶段。 通常Nmap在进行高强度的扫描时用它确定正在运行的机器。 默认情况下，Nmap只对正在运行的主机进行高强度的探测如 端口扫描，版本探测，或者操作系统探测。用<code>-P0</code>禁止 主机发现会使Nmap对<em>每一个</em>指定的目标IP地址 进行所要求的扫描。所以如果在命令行指定一个B类目标地址空间(/16)， 所有 65,536 个IP地址都会被扫描。 <code>-P0</code>的第二个字符是数字0而不是字母O。 和列表扫描一样，跳过正常的主机发现，但不是打印一个目标列表， 而是继续执行所要求的功能，就好像每个IP都是活动的。</p>
<h3 id="PS-portlist-TCP-SYN-Ping"><a href="#PS-portlist-TCP-SYN-Ping" class="headerlink" title="-PS [portlist] (TCP SYN Ping)"></a><code>-PS [portlist]</code> (TCP SYN Ping)</h3><p>该选项发送一个设置了SYN标志位的空TCP报文。 默认目的端口为80 (可以通过改变<code>nmap.h</code>) 文件中的DEFAULT-TCP-PROBE-PORT值进行配置，但不同的端口也可以作为选项指定。 甚至可以指定一个以逗号分隔的端口列表(如 <code>-PS22，23，25，80，113，1050，35000</code>)， 在这种情况下，每个端口会被并发地扫描。</p>
<p>SYN标志位告诉对方您正试图建立一个连接。 通常目标端口是关闭的，一个RST (复位) 包会发回来。 如果碰巧端口是开放的，目标会进行TCP三步握手的第二步，回应 一个SYN/ACK TCP报文。然后运行Nmap的机器则会扼杀这个正在建立的连接， 发送一个RST而非ACK报文，否则，一个完全的连接将会建立。 RST报文是运行Nmap的机器而不是Nmap本身响应的，因为它对收到 的SYN/ACK感到很意外。</p>
<p>Nmap并不关心端口开放还是关闭。 无论RST还是SYN/ACK响应都告诉Nmap该主机正在运行。</p>
<p>在UNIX机器上，通常只有特权用户 <code>root</code> 能否发送和接收 原始的TCP报文。因此作为一个变通的方法，对于非特权用户， Nmap会为每个目标主机进行系统调用connect()，它也会发送一个SYN 报文来尝试建立连接。如果connect()迅速返回成功或者一个ECONNREFUSED 失败，下面的TCP堆栈一定已经收到了一个SYN/ACK或者RST，该主机将被 标志位为在运行。 如果连接超时了，该主机就标志位为down掉了。这种方法也用于IPv6 连接，因为Nmap目前还不支持原始的IPv6报文。</p>
<h3 id="PA-portlist-TCP-ACK-Ping"><a href="#PA-portlist-TCP-ACK-Ping" class="headerlink" title="-PA [portlist] (TCP ACK Ping)"></a><code>-PA [portlist]</code> (TCP ACK Ping)</h3><p>TCP ACK ping和刚才讨论的SYN ping相当类似。 也许您已经猜到了，区别就是设置TCP的ACK标志位而不是SYN标志位。 ACK报文表示确认一个建立连接的尝试，但该连接尚未完全建立。 所以远程主机应该总是回应一个RST报文， 因为它们并没有发出过连接请求到运行Nmap的机器，如果它们正在运行的话。</p>
<p><code>-PA</code>选项使用和SYN探测相同的默认端口(80)，也可以 用相同的格式指定目标端口列表。如果非特权用户尝试该功能， 或者指定的是IPv6目标，前面说过的connect()方法将被使用。 这个方法并不完美，因为它实际上发送的是SYN报文，而不是ACK报文。</p>
<p>提供SYN和ACK两种ping探测的原因是使通过防火墙的机会尽可能大。 许多管理员会配置他们的路由器或者其它简单的防火墙来封锁SYN报文，除非 连接目标是那些公开的服务器像公司网站或者邮件服务器。 这可以阻止其它进入组织的连接，同时也允许用户访问互联网。 这种无状态的方法几乎不占用防火墙/路由器的资源，因而被硬件和软件过滤器 广泛支持。Linux Netfilter/iptables 防火墙软件提供方便的 <code>--syn</code>选项来实现这种无状态的方法。 当这样的无状态防火墙规则存在时，发送到关闭目标端口的SYN ping探测 (<code>-PS</code>) 很可能被封锁。这种情况下，ACK探测格外有闪光点，因为它正好利用了 这样的规则。</p>
<p>另外一种常用的防火墙用有状态的规则来封锁非预期的报文。 这一特性已开始只存在于高端防火墙，但是这些年类它越来越普遍了。 Linux Netfilter/iptables 通过 <code>--state</code>选项支持这一特性，它根据连接状态把报文 进行分类。SYN探测更有可能用于这样的系统，由于没头没脑的ACK报文 通常会被识别成伪造的而丢弃。解决这个两难的方法是通过即指定 <code>-PS</code>又指定<code>-PA</code>来即发送SYN又发送ACK。</p>
<h3 id="PU-portlist-UDP-Ping"><a href="#PU-portlist-UDP-Ping" class="headerlink" title="-PU [portlist] (UDP Ping)"></a><code>-PU [portlist]</code> (UDP Ping)</h3><p>还有一个主机发现的选项是UDP ping，它发送一个空的(除非指定了<code>--data-length</code> UDP报文到给定的端口。端口列表的格式和前面讨论过的<code>-PS</code>和<code>-PA</code>选项还是一样。 如果不指定端口，默认是31338。该默认值可以通过在编译时改变<code>nmap.h</code>文件中的 DEFAULT-UDP-PROBE-PORT值进行配置。默认使用这样一个奇怪的端口是因为对开放端口 进行这种扫描一般都不受欢迎。</p>
<p>如果目标机器的端口是关闭的，UDP探测应该马上得到一个ICMP端口无法到达的回应报文。 这对于Nmap意味着该机器正在运行。 许多其它类型的ICMP错误，像主机/网络无法到达或者TTL超时则表示down掉的或者不可到达的主机。 没有回应也被这样解释。如果到达一个开放的端口，大部分服务仅仅忽略这个 空报文而不做任何回应。这就是为什么默认探测端口是31338这样一个 极不可能被使用的端口。少数服务如chargen会响应一个空的UDP报文， 从而向Nmap表明该机器正在运行。</p>
<p>该扫描类型的主要优势是它可以穿越只过滤TCP的防火墙和过滤器。 例如。我曾经有过一个Linksys BEFW11S4无线宽带路由器。默认情况下， 该设备对外的网卡过滤所有TCP端口，但UDP探测仍然会引发一个端口不可到达 的消息，从而暴露了它自己。</p>
<h3 id="PE-PP-PM-ICMP-Ping-Types"><a href="#PE-PP-PM-ICMP-Ping-Types" class="headerlink" title="-PE; -PP; -PM (ICMP Ping Types)"></a><code>-PE</code>; <code>-PP</code>; <code>-PM</code> (ICMP Ping Types)</h3><p>除了前面讨论的这些不常见的TCP和UDP主机发现类型， Nmap也能发送世人皆知的ping 程序所发送的报文。Nmap发送一个ICMP type 8 (回声请求)报文到目标IP地址， 期待从运行的主机得到一个type 0 (回声响应)报文。 对于网络探索者而言，不幸的是，许多主机和 防火墙现在封锁这些报文，而不是按期望的那样响应， 参见<a target="_blank" rel="noopener" href="http://www.rfc-editor.org/rfc/rfc1122.txt">RFC 1122</a>。因此，仅仅ICMP扫描对于互联网上的目标通常是不够的。 但对于系统管理员监视一个内部网络，它们可能是实际有效的途径。 使用<code>-PE</code>选项打开该回声请求功能。</p>
<p>虽然回声请求是标准的ICMP ping查询， Nmap并不止于此。ICMP标准 (<a target="_blank" rel="noopener" href="http://www.rfc-editor.org/rfc/rfc792.txt">RFC 792</a>)还规范了时间戳请求，信息请求 request，和地址掩码请求，它们的代码分别是13，15和17。 虽然这些查询的表面目的是获取信息如地址掩码和当前时间， 它们也可以很容易地用于主机发现。 很简单，回应的系统就是在运行的系统。Nmap目前没有实现信息请求报文， 因为它们还没有被广泛支持。RFC 1122 坚持 “主机不应该实现这些消息”。 时间戳和地址掩码查询可以分别用<code>-PP</code>和<code>-PM</code>选项发送。 时间戳响应(ICMP代码14)或者地址掩码响应(代码18)表示主机在运行。 当管理员特别封锁了回声请求报文而忘了其它ICMP查询可能用于 相同目的时，这两个查询可能很有价值。</p>
<h3 id="PR-ARP-Ping"><a href="#PR-ARP-Ping" class="headerlink" title="-PR (ARP Ping)"></a><code>-PR</code> (ARP Ping)</h3><p>最常见的Nmap使用场景之一是扫描一个以太局域网。 在大部分局域网上，特别是那些使用基于 RFC1918私有地址范围的网络，在一个给定的时间绝大部分 IP地址都是不使用的。 当Nmap试图发送一个原始IP报文如ICMP回声请求时， 操作系统必须确定对应于目标IP的硬件 地址(ARP)，这样它才能把以太帧送往正确的地址。 这一般比较慢而且会有些问题，因为操作系统设计者认为一般不会在短时间内 对没有运行的机器作几百万次的ARP请求。</p>
<p>当进行ARP扫描时，Nmap用它优化的算法管理ARP请求。 当它收到响应时， Nmap甚至不需要担心基于IP的ping报文，既然它已经知道该主机正在运行了。 这使得ARP扫描比基于IP的扫描更快更可靠。 所以默认情况下，如果Nmap发现目标主机就在它所在的局域网上，它会进行ARP扫描。 即使指定了不同的ping类型(如 <code>-PI</code>或者 <code>-PS</code>) ，Nmap也会对任何相同局域网上的目标机使用ARP。 如果您真的不想要ARP扫描，指定 <code>--send-ip</code>。</p>
<h3 id="n-不用域名解析"><a href="#n-不用域名解析" class="headerlink" title="-n (不用域名解析)"></a><code>-n</code> (不用域名解析)</h3><p>告诉Nmap <em>永不</em>对它发现的活动IP地址进行反向域名解析。 既然DNS一般比较慢，这可以让事情更快些。</p>
<h3 id="R-为所有目标解析域名"><a href="#R-为所有目标解析域名" class="headerlink" title="-R (为所有目标解析域名)"></a><code>-R</code> (为所有目标解析域名)</h3><p>告诉Nmap <em>永远</em> 对目标IP地址作反向域名解析。 一般只有当发现机器正在运行时才进行这项操作。</p>
<h3 id="system-dns-使用系统域名解析器"><a href="#system-dns-使用系统域名解析器" class="headerlink" title="--system-dns (使用系统域名解析器)"></a><code>--system-dns</code> (使用系统域名解析器)</h3><p>默认情况下，Nmap通过直接发送查询到您的主机上配置的域名服务器 来解析域名。为了提高性能，许多请求 (一般几十个 ) 并发执行。如果您希望使用系统自带的解析器，就指定该选项 (通过getnameinfo()调用一次解析一个IP)。除非Nmap的DNS代码有bug—如果是这样，请联系我们。 一般不使用该选项，因为它慢多了。系统解析器总是用于IPv6扫描。</p>
<hr>
<h2 id="Nmap核心功能-端口扫描基础"><a href="#Nmap核心功能-端口扫描基础" class="headerlink" title="Nmap核心功能 - 端口扫描基础"></a>Nmap核心功能 - 端口扫描基础</h2><p><strong>nmap <em><code>&lt;target&gt;</code></em></strong>这个简单的命令扫描主机<em><code>&lt;target&gt;</code></em>上的超过 1660个TCP端口。 。许多传统的端口扫描器只列出所有端口是开放还是关闭的， Nmap的信息粒度比它们要细得多。 它把端口分成六个状态: <code>open</code>(开放的)， <code>closed</code>(关闭的)，<code>filtered</code>(被过滤的)， <code>unfiltered</code>(未被过滤的)， <code>open|filtered(开放或者被过滤的)</code>，或者 <code>closed|filtered(关闭或者被过滤的)</code>。</p>
<h3 id="open-开放的"><a href="#open-开放的" class="headerlink" title="open(开放的)"></a>open(开放的)</h3><p>应用程序正在该端口接收TCP 连接或者UDP报文。发现这一点常常是端口扫描 的主要目标。安全意识强的人们知道每个开放的端口 都是攻击的入口。攻击者或者入侵测试者想要发现开放的端口。 而管理员则试图关闭它们或者用防火墙保护它们以免妨碍了合法用户。 非安全扫描可能对开放的端口也感兴趣，因为它们显示了网络上那些服务可供使用。</p>
<h3 id="closed-关闭的"><a href="#closed-关闭的" class="headerlink" title="closed(关闭的)"></a>closed(关闭的)</h3><p>关闭的端口对于Nmap也是可访问的(它接受Nmap的探测报文并作出响应)， 但没有应用程序在其上监听。 它们可以显示该IP地址上(主机发现，或者ping扫描)的主机正在运行up 也对部分操作系统探测有所帮助。 因为关闭的关口是可访问的，也许过会儿值得再扫描一下，可能一些又开放了。 系统管理员可能会考虑用防火墙封锁这样的端口。 那样他们就会被显示为被过滤的状态，下面讨论。</p>
<h3 id="filtered-被过滤的"><a href="#filtered-被过滤的" class="headerlink" title="filtered(被过滤的)"></a>filtered(被过滤的)</h3><p>由于包过滤阻止探测报文到达端口， Nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由器规则 或者主机上的软件防火墙。这样的端口让攻击者感觉很挫折，因为它们几乎不提供 任何信息。有时候它们响应ICMP错误消息如类型3代码13 (无法到达目标: 通信被管理员禁止)，但更普遍的是过滤器只是丢弃探测帧， 不做任何响应。 这迫使Nmap重试若干次以访万一探测包是由于网络阻塞丢弃的。 这使得扫描速度明显变慢。</p>
<h3 id="unfiltered-未被过滤的"><a href="#unfiltered-未被过滤的" class="headerlink" title="unfiltered(未被过滤的)"></a>unfiltered(未被过滤的)</h3><p>未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。 只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。 用其它类型的扫描如窗口扫描，SYN扫描，或者FIN扫描来扫描未被过滤的端口可以帮助确定 端口是否开放。</p>
<h3 id="open-filtered-开放或者被过滤的"><a href="#open-filtered-开放或者被过滤的" class="headerlink" title="open|filtered(开放或者被过滤的)"></a>open|filtered(开放或者被过滤的)</h3><p>当无法确定端口是开放还是被过滤的，Nmap就把该端口划分成 这种状态。开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃 了探测报文或者它引发的任何响应。因此Nmap无法确定该端口是开放的还是被过滤的。 UDP，IP协议， FIN，Null，和Xmas扫描可能把端口归入此类。</p>
<h3 id="closed-filtered-关闭或者被过滤的"><a href="#closed-filtered-关闭或者被过滤的" class="headerlink" title="closed|filtered(关闭或者被过滤的)"></a>closed|filtered(关闭或者被过滤的)</h3><p>该状态用于Nmap不能确定端口是关闭的还是被过滤的。 它只可能出现在IPID Idle扫描中。</p>
<hr>
<h2 id="端口扫描技术"><a href="#端口扫描技术" class="headerlink" title="端口扫描技术"></a>端口扫描技术</h2><p>Nmap支持大约十几种扫描技术。 一般一次只用一种方法， 除了UDP扫描(<code>-sU</code>)可能和任何一种TCP扫描类型结合使用。 友情提示一下，端口扫描类型的选项格式是<code>-s &lt;C&gt;</code>， 其中<em><code>&lt;C&gt;</code></em> 是个显眼的字符，通常是第一个字符。 一个例外是deprecated FTP bounce扫描(<code>-b</code>)。默认情况下，Nmap执行一个 SYN扫描，但是如果用户没有权限发送原始报文(在UNIX上需要root权限)或者如果指定的是IPv6目标，Nmap调用connect()。 非特权用户只能执行connect()和ftp bounce扫描。</p>
<h3 id="sS-TCP-SYN扫描"><a href="#sS-TCP-SYN扫描" class="headerlink" title="-sS (TCP SYN扫描)"></a><code>-sS</code> (TCP SYN扫描)</h3><p>SYN扫描作为默认的也是最受欢迎的扫描选项，是有充分理由的。 它执行得很快，在一个没有入侵防火墙的快速网络上，每秒钟可以扫描数千个 端口。 SYN扫描相对来说不张扬，不易被注意到，因为它从来不完成TCP连接。 它也不像Fin/Null/Xmas，Maimon和Idle扫描依赖于特定平台，而可以应对任何兼容的 TCP协议栈。 它还可以明确可靠地区分<code>open</code>(开放的)， <code>closed</code>(关闭的)，和<code>filtered</code>(被过滤的) 状态</p>
<p>它常常被称为半开放扫描， 因为它不打开一个完全的TCP连接。它发送一个SYN报文， 就像您真的要打开一个连接，然后等待响应。 SYN/ACK表示端口在监听 (开放)，而 RST (复位)表示没有监听者。如果数次重发后仍没响应， 该端口就被标记为被过滤。如果收到ICMP不可到达错误 (类型3，代码1，2，3，9，10，或者13)，该端口也被标记为被过滤。</p>
<h3 id="sT-TCP-connect-扫描"><a href="#sT-TCP-connect-扫描" class="headerlink" title="-sT (TCP connect()扫描)"></a><code>-sT</code> (TCP connect()扫描)</h3><p>当SYN扫描不能用时，CP Connect()扫描就是默认的TCP扫描。 当用户没有权限发送原始报文或者扫描IPv6网络时，就是这种情况。 Instead of writing raw packets as most other scan types do，Nmap通过创建<code>connect()</code> 系统调用要求操作系统和目标机以及端口建立连接，而不像其它扫描类型直接发送原始报文。 这是和Web浏览器，P2P客户端以及大多数其它网络应用程序用以建立连接一样的 高层系统调用。它是叫做Berkeley Sockets API编程接口的一部分。Nmap用 该API获得每个连接尝试的状态信息，而不是读取响应的原始报文。</p>
<p>当SYN扫描可用时，它通常是更好的选择。因为Nmap对高层的 <code>connect()</code>调用比对原始报文控制更少， 所以前者效率较低。 该系统调用完全连接到开放的目标端口而不是像SYN扫描进行 半开放的复位。这不仅花更长时间，需要更多报文得到同样信息，目标机也更可能 记录下连接。IDS(入侵检测系统)可以捕获两者，但大部分机器没有这样的警报系统。 当Nmap连接，然后不发送数据又关闭连接， 许多普通UNIX系统上的服务会在syslog留下记录，有时候是一条加密的错误消息。 此时，有些真正可怜的服务会崩溃，虽然这不常发生。如果管理员在日志里看到来自同一系统的 一堆连接尝试，她应该知道她的系统被扫描了。</p>
<h3 id="sU-UDP扫描"><a href="#sU-UDP扫描" class="headerlink" title="-sU (UDP扫描)"></a><code>-sU</code> (UDP扫描)</h3><p>虽然互联网上很多流行的服务运行在TCP 协议上，<a target="_blank" rel="noopener" href="http://www.rfc-editor.org/rfc/rfc768.txt">UDP</a>服务也不少。 DNS，SNMP，和DHCP (注册的端口是53，161/162，和67/68)是最常见的三个。 因为UDP扫描一般较慢，比TCP更困难，一些安全审核人员忽略这些端口。 这是一个错误，因为可探测的UDP服务相当普遍，攻击者当然不会忽略整个协议。 所幸，Nmap可以帮助记录并报告UDP端口。</p>
<p>UDP扫描用<code>-sU</code>选项激活。它可以和TCP扫描如 SYN扫描 (<code>-sS</code>)结合使用来同时检查两种协议。</p>
<p>UDP扫描发送空的(没有数据)UDP报头到每个目标端口。 如果返回ICMP端口不可到达错误(类型3，代码3)， 该端口是<code>closed</code>(关闭的)。 其它ICMP不可到达错误(类型3， 代码1，2，9，10，或者13)表明该端口是<code>filtered</code>(被过滤的)。 偶尔地，某服务会响应一个UDP报文，证明该端口是<code>open</code>(开放的)。 如果几次重试后还没有响应，该端口就被认为是 <code>open|filtered</code>(开放|被过滤的)。 这意味着该端口可能是开放的，也可能包过滤器正在封锁通信。 可以用版本扫描(<code>-sV</code>)帮助区分真正的开放端口和被过滤的端口。</p>
<p>UDP扫描的巨大挑战是怎样使它更快速。 开放的和被过滤的端口很少响应，让Nmap超时然后再探测，以防探测帧或者 响应丢失。关闭的端口常常是更大的问题。 它们一般发回一个ICMP端口无法到达错误。但是不像关闭的TCP端口响应SYN或者Connect 扫描所发送的RST报文，许多主机在默认情况下限制ICMP端口不可到达消息。 Linux和Solaris对此特别严格。例如， Linux 2.4.20内核限制一秒钟只发送一条目标不可到达消息 (见<code>net/ipv4/icmp。c</code>)。</p>
<p>Nmap探测速率限制并相应地减慢来避免用那些目标机会丢弃的无用报文来阻塞 网络。不幸的是，Linux式的一秒钟一个报文的限制使65,536个端口的扫描要花 18小时以上。加速UDP扫描的方法包括并发扫描更多的主机，先只对主要端口进行快速 扫描，从防火墙后面扫描，使用<code>--host-timeout</code>跳过慢速的 主机。</p>
<h3 id="sN-sF-sX-TCP-Null，FIN，and-Xmas扫描"><a href="#sN-sF-sX-TCP-Null，FIN，and-Xmas扫描" class="headerlink" title="-sN; -sF; -sX (TCP Null，FIN，and Xmas扫描)"></a><code>-sN</code>; <code>-sF</code>; <code>-sX</code> (TCP Null，FIN，and Xmas扫描)</h3><p>这三种扫描类型 (甚至用下一节描述的 <code>--scanflags</code> 选项的更多类型) 在<a target="_blank" rel="noopener" href="http://www.rfc-editor.org/rfc/rfc793.txt">TCP RFC</a> 中发掘了一个微妙的方法来区分<code>open</code>(开放的)和 <code>closed</code>(关闭的)端口。第65页说“如果 [目标]端口状态是关闭的…. 进入的不含RST的报文导致一个RST响应。” 接下来的一页 讨论不设置SYN，RST，或者ACK位的报文发送到开放端口: “理论上，这不应该发生，如果您确实收到了，丢弃该报文，返回。 ”</p>
<p>如果扫描系统遵循该RFC，当端口关闭时，任何不包含SYN，RST，或者ACK位的报文会导致 一个RST返回，而当端口开放时，应该没有任何响应。只要不包含SYN，RST，或者ACK， 任何其它三种(FIN，PSH，and URG)的组合都行。Nmap有三种扫描类型利用这一点：</p>
<ul>
<li><p>Null扫描 (<code>-sN</code>)</p>
<p>不设置任何标志位(tcp标志头是0)</p>
</li>
<li><p>FIN扫描 (<code>-sF</code>)</p>
<p>只设置TCP FIN标志位。</p>
</li>
<li><p>Xmas扫描 (<code>-sX</code>)</p>
<p>设置FIN，PSH，和URG标志位，就像点亮圣诞树上所有的灯一样。</p>
</li>
</ul>
<p>除了探测报文的标志位不同，这三种扫描在行为上完全一致。 如果收到一个RST报文，该端口被认为是 <code>closed</code>(关闭的)，而没有响应则意味着 端口是<code>open|filtered(开放或者被过滤的)</code>。 如果收到ICMP不可到达错误(类型 3，代号 1，2，3，9，10，或者13)，该端口就被标记为 <code>被过滤的</code>。</p>
<p>这些扫描的关键优势是它们能躲过一些无状态防火墙和报文过滤路由器。 另一个优势是这些扫描类型甚至比SYN扫描还要隐秘一些。但是别依赖它 — 多数 现代的IDS产品可以发现它们。一个很大的不足是并非所有系统都严格遵循RFC 793。 许多系统不管端口开放还是关闭，都响应RST。 这导致所有端口都标记为<code>closed</code>(关闭的)。 这样的操作系统主要有Microsoft Windows，许多Cisco设备，BSDI，以及IBM OS/400。 但是这种扫描对多数UNIX系统都能工作。这些扫描的另一个不足是 它们不能辨别<code>open</code>(开放的)端口和一些特定的 <code>filtered</code>(被过滤的)端口，从而返回 <code>open|filtered(开放或者被过滤的)</code>。</p>
<h3 id="sA-TCP-ACK扫描"><a href="#sA-TCP-ACK扫描" class="headerlink" title="-sA (TCP ACK扫描)"></a><code>-sA</code> (TCP ACK扫描)</h3><p>这种扫描与目前为止讨论的其它扫描的不同之处在于 它不能确定<code>open</code>(开放的)或者 <code>open|filtered(开放或者过滤的)</code>)端口。 它用于发现防火墙规则，确定它们是有状态的还是无状态的，哪些端口是被过滤的。</p>
<p>ACK扫描探测报文只设置ACK标志位(除非您使用 <code>--scanflags</code>)。当扫描未被过滤的系统时， <code>open</code>(开放的)和<code>closed</code>(关闭的) 端口 都会返回RST报文。Nmap把它们标记为 <code>unfiltered</code>(未被过滤的)，意思是 ACK报文不能到达，但至于它们是<code>open</code>(开放的)或者 <code>closed</code>(关闭的) 无法确定。不响应的端口 或者发送特定的ICMP错误消息(类型3，代号1，2，3，9，10， 或者13)的端口，标记为 <code>filtered</code>(被过滤的)。</p>
<h3 id="sW-TCP窗口扫描"><a href="#sW-TCP窗口扫描" class="headerlink" title="-sW (TCP窗口扫描)"></a><code>-sW</code> (TCP窗口扫描)</h3><p>除了利用特定系统的实现细节来区分开放端口和关闭端口，当收到RST时不总是打印<code>unfiltered</code>， 窗口扫描和ACK扫描完全一样。 它通过检查返回的RST报文的TCP窗口域做到这一点。 在某些系统上，开放端口用正数表示窗口大小(甚至对于RST报文) 而关闭端口的窗口大小为0。因此，当收到RST时，窗口扫描不总是把端口标记为 <code>unfiltered</code>， 而是根据TCP窗口值是正数还是0，分别把端口标记为<code>open</code>或者 <code>closed</code></p>
<p>该扫描依赖于互联网上少数系统的实现细节， 因此您不能永远相信它。不支持它的系统会通常返回所有端口<code>closed</code>。 当然，一台机器没有开放端口也是有可能的。 如果大部分被扫描的端口是 <code>closed</code>，而一些常见的端口 (如 22， 25，53) 是 <code>filtered</code>，该系统就非常可疑了。 偶尔地，系统甚至会显示恰恰相反的行为。 如果您的扫描显示1000个开放的端口和3个关闭的或者被过滤的端口， 那么那3个很可能也是开放的端口。</p>
<h3 id="sM-TCP-Maimon扫描"><a href="#sM-TCP-Maimon扫描" class="headerlink" title="-sM (TCP Maimon扫描)"></a><code>-sM</code> (TCP Maimon扫描)</h3><p>Maimon扫描是用它的发现者Uriel Maimon命名的。他在 Phrack Magazine issue #49 (November 1996)中描述了这一技术。 Nmap在两期后加入了这一技术。 这项技术和Null，FIN，以及Xmas扫描完全一样，除了探测报文是FIN/ACK。 根据RFC 793 (TCP)，无论端口开放或者关闭，都应该对这样的探测响应RST报文。 然而，Uriel注意到如果端口开放，许多基于BSD的系统只是丢弃该探测报文。</p>
<h3 id="scanflags-定制的TCP扫描"><a href="#scanflags-定制的TCP扫描" class="headerlink" title="--scanflags (定制的TCP扫描)"></a><code>--scanflags</code> (定制的TCP扫描)</h3><p>真正的Nmap高级用户不需要被这些现成的扫描类型束缚。 <code>--scanflags</code>选项允许您通过指定任意TCP标志位来设计您自己的扫描。 让您的创造力流动，躲开那些仅靠本手册添加规则的入侵检测系统！</p>
<p><code>--scanflags</code>选项可以是一个数字标记值如9 (PSH和FIN)， 但使用字符名更容易些。 只要是<code>URG</code>， <code>ACK</code>，<code>PSH</code>， <code>RST</code>，<code>SYN</code>，and <code>FIN</code>的任何组合就行。例如，<code>--scanflags URGACKPSHRSTSYNFIN</code>设置了所有标志位，但是这对扫描没有太大用处。 标志位的顺序不重要。</p>
<p>除了设置需要的标志位，您也可以设置 TCP扫描类型(如<code>-sA</code>或者<code>-sF</code>)。 那个基本类型告诉Nmap怎样解释响应。例如， SYN扫描认为没有响应意味着 <code>filtered</code>端口，而FIN扫描则认为是 <code>open|filtered</code>。 除了使用您指定的TCP标记位，Nmap会和基本扫描类型一样工作。 如果您不指定基本类型，就使用SYN扫描。</p>
<h3 id="sI-lt-zombie-host-probeport-gt-Idlescan"><a href="#sI-lt-zombie-host-probeport-gt-Idlescan" class="headerlink" title="-sI &lt;zombie host[:probeport]&gt; (Idlescan)"></a><code>-sI &lt;zombie host[:probeport]&gt;</code> (Idlescan)</h3><p>这种高级的扫描方法允许对目标进行真正的TCP端口盲扫描 (意味着没有报文从您的真实IP地址发送到目标)。相反，side-channel攻击 利用zombie主机上已知的IP分段ID序列生成算法来窥探目标上开放端口的信息。 IDS系统将显示扫描来自您指定的zombie机(必须运行并且符合一定的标准)。 这种奇妙的扫描类型太复杂了，不能在此完全描述，所以我写一篇非正式的论文， 发布在<a target="_blank" rel="noopener" href="https://nmap.org/book/idlescan.html"><code>https://nmap.org/book/idlescan.html</code></a>。</p>
<p>除了极端隐蔽(由于它不从真实IP地址发送任何报文)， 该扫描类型可以建立机器间的基于IP的信任关系。 端口列表<em>从zombie 主机的角度。</em>显示开放的端口。 因此您可以尝试用您认为(通过路由器/包过滤规则)可能被信任的 zombies扫描目标。</p>
<p>如果您由于IPID改变希望探测zombie上的特定端口， 您可以在zombie 主机后加上一个冒号和端口号。 否则Nmap会使用默认端口(80)。</p>
<h3 id="sO-IP协议扫描"><a href="#sO-IP协议扫描" class="headerlink" title="-sO (IP协议扫描)"></a><code>-sO</code> (IP协议扫描)</h3><p>IP 协议扫描可以让您确定目标机支持哪些IP协议 (TCP，ICMP，IGMP，等等)。从技术上说，这不是端口扫描 ，既然它遍历的是IP协议号而不是TCP或者UDP端口号。 但是它仍使用 <code>-p</code>选项选择要扫描的协议号， 用正常的端口表格式报告结果，甚至用和真正的端口扫描一样 的扫描引擎。因此它和端口扫描非常接近，也被放在这里讨论。</p>
<p>除了本身很有用，协议扫描还显示了开源软件的力量。 尽管基本想法非常简单，我过去从没想过增加这一功能也没收到任何对它的请求。 在2000年夏天，Gerhard Rieger孕育了这个想法，写了一个很棒的补丁程序，发送到nmap-hackers邮件列表。 我把那个补丁加入了Nmap，第二天发布了新版本。 几乎没有商业软件会有用户有足够的热情设计并贡献他们的改进。</p>
<p>协议扫描以和UDP扫描类似的方式工作。它不是在UDP报文的端口域上循环， 而是在IP协议域的8位上循环，发送IP报文头。 报文头通常是空的，不包含数据，甚至不包含所申明的协议的正确报文头 TCP，UDP，和ICMP是三个例外。它们三个会使用正常的协议头，因为否则某些系 统拒绝发送，而且Nmap有函数创建它们。协议扫描不是注意ICMP端口不可到达消息， 而是ICMP <em>协议</em>不可到达消息。如果Nmap从目标主机收到 任何协议的任何响应，Nmap就把那个协议标记为<code>open</code>。 ICMP协议不可到达 错误(类型 3，代号 2) 导致协议被标记为 <code>closed</code>。其它ICMP不可到达协议(类型 3，代号 1，3，9，10，或者13) 导致协议被标记为 <code>filtered</code> (虽然同时他们证明ICMP是 <code>open</code> )。如果重试之后仍没有收到响应， 该协议就被标记为<code>open|filtered</code></p>
<h3 id="b-lt-ftp-relay-host-gt-FTP弹跳扫描"><a href="#b-lt-ftp-relay-host-gt-FTP弹跳扫描" class="headerlink" title="-b &lt;ftp relay host&gt; (FTP弹跳扫描)"></a><code>-b &lt;ftp relay host&gt;</code> (FTP弹跳扫描)</h3><p>FTP协议的一个有趣特征(<a target="_blank" rel="noopener" href="http://www.rfc-editor.org/rfc/rfc959.txt">RFC 959</a>) 是支持所谓代理ftp连接。它允许用户连接到一台FTP服务器，然后要求文件送到一台第三方服务器。 这个特性在很多层次上被滥用，所以许多服务器已经停止支持它了。其中一种就是导致FTP服务器对其它主机端口扫描。 只要请求FTP服务器轮流发送一个文件到目标主机上的所感兴趣的端口。 错误消息会描述端口是开放还是关闭的。 这是绕过防火墙的好方法，因为FTP服务器常常被置于可以访问比Web主机更多其它内部主机的位置。 Nmap用<code>-b</code>选项支持ftp弹跳扫描。参数格式是 <em><code>&lt;username&gt;</code></em>:<em><code>&lt;password&gt;</code></em>@<em><code>&lt;server&gt;</code></em>:<em><code>&lt;port&gt;</code></em>。 <em><code>&lt;Server&gt;</code></em> 是某个脆弱的FTP服务器的名字或者IP地址。 您也许可以省略<em><code>&lt;username&gt;</code></em>:<em><code>&lt;password&gt;</code></em>， 如果服务器上开放了匿名用户(user:<code>anonymous</code> password:<code>-wwwuser@</code>)。 端口号(以及前面的冒号) 也可以省略，如果<em><code>&lt;server&gt;</code></em>使用默认的FTP端口(21)。</p>
<p>当Nmap1997年发布时，这个弱点被广泛利用，但现在大部分已经被fix了。 脆弱的服务器仍然存在，所以如果其它都失败了，这也值得一试。 如果您的目标是绕过防火墙，扫描目标网络上的开放的21端口(或者 甚至任何ftp服务，如果您用版本探测扫描所有端口)， 然后对每个尝试弹跳扫描。Nmap会告诉您该主机脆弱与否。 如果您只是试着玩Nmap，您不必(事实上，不应该)限制您自己。 在您随机地在互联网上寻找脆弱的FTP服务器时，考虑一下系统管理员不太喜欢您这样滥用他们的服务器。</p>
<hr>
<h2 id="端口说明和扫描顺序"><a href="#端口说明和扫描顺序" class="headerlink" title="端口说明和扫描顺序"></a>端口说明和扫描顺序</h2><p>默认扫描1-1024端口</p>
<h3 id="p-lt-port-ranges-gt-只扫描指定的端口"><a href="#p-lt-port-ranges-gt-只扫描指定的端口" class="headerlink" title="-p &lt;port ranges&gt; (只扫描指定的端口)"></a><code>-p &lt;port ranges&gt;</code> (只扫描指定的端口)</h3><p>该选项指明您想扫描的端口，覆盖默认值。 单个端口和用连字符表示的端口范围(如 1-1023)都可以。 范围的开始以及/或者结束值可以被省略， 分别导致Nmap使用1和65535。所以您可以指定 <code>-p-</code>从端口1扫描到65535。 如果您特别指定，也可以扫描端口0。 对于IP协议扫描(<code>-sO</code>)，该选项指定您希望扫描的协议号 (0-255)。</p>
<p>当既扫描TCP端口又扫描UDP端口时，您可以通过在端口号前加上<code>T:</code> 或者<code>U:</code>指定协议。 协议限定符一直有效您直到指定另一个。 例如，参数 <code>-p U:53，111，137，T:21-25，80，139，8080</code> 将扫描UDP 端口53，111，和137，同时扫描列出的TCP端口。注意，要既扫描 UDP又扫描TCP，您必须指定 <code>-sU</code> ，以及至少一个TCP扫描类型(如 <code>-sS</code>，<code>-sF</code>，或者 <code>-sT</code>)。如果没有给定协议限定符， 端口号会被加到所有协议列表。</p>
<h3 id="F-快速-有限的端口-扫描"><a href="#F-快速-有限的端口-扫描" class="headerlink" title="-F (快速 (有限的端口) 扫描)"></a><code>-F</code> (快速 (有限的端口) 扫描)</h3><p>在nmap的<code>nmap-services</code> 文件中(对于<code>-sO</code>，是协议文件)指定您想要扫描的端口。 这比扫描所有65535个端口快得多。 因为该列表包含如此多的TCP端口(1200多)，这和默认的TCP扫描 scan (大约1600个端口)速度差别不是很大。如果您用<code>--datadir</code>选项指定您自己的 小小的<code>nmap-services</code>文件 ，差别会很惊人。</p>
<h3 id="r-不要按随机顺序扫描端口"><a href="#r-不要按随机顺序扫描端口" class="headerlink" title="-r (不要按随机顺序扫描端口)"></a><code>-r</code> (不要按随机顺序扫描端口)</h3><p>默认情况下，Nmap按随机顺序扫描端口 (除了出于效率的考虑，常用的端口前移)。这种随机化通常都是受欢迎的， 但您也可以指定<code>-r</code>来顺序端口扫描。</p>
<hr>
<h2 id="服务和版本探测"><a href="#服务和版本探测" class="headerlink" title="服务和版本探测"></a>服务和版本探测</h2><h3 id="sV-版本探测"><a href="#sV-版本探测" class="headerlink" title="-sV (版本探测)"></a><code>-sV</code> (版本探测)</h3><p>打开版本探测。 您也可以用<code>-A</code>同时打开操作系统探测和版本探测。</p>
<h3 id="allports-不为版本探测排除任何端口"><a href="#allports-不为版本探测排除任何端口" class="headerlink" title="--allports (不为版本探测排除任何端口)"></a><code>--allports</code> (不为版本探测排除任何端口)</h3><p>默认情况下，Nmap版本探测会跳过9100 TCP端口，因为一些打印机简单地打印送到该端口的 任何数据，这回导致数十页HTTP get请求，二进制 SSL会话请求等等被打印出来。这一行为可以通过修改或删除<code>nmap-service-probes</code> 中的<code>Exclude</code>指示符改变， 您也可以不理会任何<code>Exclude</code>指示符，指定<code>--allports</code>扫描所有端口</p>
<h3 id="version-intensity-lt-intensity-gt-设置-版本扫描强度"><a href="#version-intensity-lt-intensity-gt-设置-版本扫描强度" class="headerlink" title="--version-intensity &lt;intensity&gt; (设置 版本扫描强度)"></a><code>--version-intensity &lt;intensity&gt;</code> (设置 版本扫描强度)</h3><p>当进行版本扫描(<code>-sV</code>)时，nmap发送一系列探测报文 ，每个报文都被赋予一个1到9之间的值。 被赋予较低值的探测报文对大范围的常见服务有效，而被赋予较高值的报文 一般没什么用。强度水平说明了应该使用哪些探测报文。数值越高， 服务越有可能被正确识别。 然而，高强度扫描花更多时间。强度值必须在0和9之间。 默认是7。当探测报文通过<code>nmap-service-probes</code> <code>ports</code>指示符 注册到目标端口时，无论什么强度水平，探测报文都会被尝试。这保证了DNS 探测将永远在任何开放的53端口尝试， SSL探测将在443端口尝试，等等。</p>
<h3 id="version-light-打开轻量级模式"><a href="#version-light-打开轻量级模式" class="headerlink" title="--version-light (打开轻量级模式)"></a><code>--version-light</code> (打开轻量级模式)</h3><p>这是 <code>--version-intensity 2</code>的方便的别名。轻量级模式使 版本扫描快许多，但它识别服务的可能性也略微小一点。</p>
<h3 id="version-all-尝试每个探测"><a href="#version-all-尝试每个探测" class="headerlink" title="--version-all (尝试每个探测)"></a><code>--version-all</code> (尝试每个探测)</h3><p><code>--version-intensity 9</code>的别名， 保证对每个端口尝试每个探测报文。</p>
<h3 id="version-trace-跟踪版本扫描活动"><a href="#version-trace-跟踪版本扫描活动" class="headerlink" title="--version-trace (跟踪版本扫描活动)"></a><code>--version-trace</code> (跟踪版本扫描活动)</h3><p>这导致Nmap打印出详细的关于正在进行的扫描的调试信息。 它是您用<code>--packet-trace</code>所得到的信息的子集。</p>
<h3 id="sR-RPC扫描"><a href="#sR-RPC扫描" class="headerlink" title="-sR (RPC扫描)"></a><code>-sR</code> (RPC扫描)</h3><p>这种方法和许多端口扫描方法联合使用。 它对所有被发现开放的TCP/UDP端口执行SunRPC程序NULL命令，来试图 确定它们是否RPC端口，如果是， 是什么程序和版本号。因此您可以有效地获得和<strong>rpcinfo -p</strong>一样的信息， 即使目标的端口映射在防火墙后面(或者被TCP包装器保护)。Decoys目前不能和RPC scan一起工作。 这作为版本扫描(<code>-sV</code>)的一部分自动打开。 由于版本探测包括它并且全面得多，<code>-sR</code>很少被需要。</p>
<hr>
<h2 id="操作系统探测"><a href="#操作系统探测" class="headerlink" title="操作系统探测"></a>操作系统探测</h2><h3 id="O-启用操作系统检测"><a href="#O-启用操作系统检测" class="headerlink" title="-O (启用操作系统检测)"></a><code>-O</code> (启用操作系统检测)</h3><p>也可以使用<code>-A</code>来同时启用操作系统检测和版本检测。</p>
<h3 id="osscan-limit-针对指定的目标进行操作系统检测"><a href="#osscan-limit-针对指定的目标进行操作系统检测" class="headerlink" title="--osscan-limit (针对指定的目标进行操作系统检测)"></a><code>--osscan-limit</code> (针对指定的目标进行操作系统检测)</h3><p>如果发现一个打开和关闭的TCP端口时，操作系统检测会更有效。 采用这个选项，Nmap只对满足这个条件的主机进行操作系统检测，这样可以 节约时间，特别在使用<code>-P0</code>扫描多个主机时。这个选项仅在使用 <code>-O</code>或<code>-A</code> 进行操作系统检测时起作用。</p>
<h3 id="osscan-guess-fuzzy-推测操作系统检测结果"><a href="#osscan-guess-fuzzy-推测操作系统检测结果" class="headerlink" title="--osscan-guess; --fuzzy (推测操作系统检测结果)"></a><code>--osscan-guess</code>; <code>--fuzzy</code> (推测操作系统检测结果)</h3><p>当Nmap无法确定所检测的操作系统时，会尽可能地提供最相近的匹配，Nmap默认 进行这种匹配，使用上述任一个选项使得Nmap的推测更加有效。</p>
<hr>
<h2 id="时间和性能"><a href="#时间和性能" class="headerlink" title="时间和性能"></a>时间和性能</h2><p>Nmap开发的最高优先级是性能。在本地网络对一个主机的默认扫描(<strong>nmap *<code>&lt;hostname&gt;</code>*</strong>)需要1/5秒。而仅仅眨眼的 时间，就需要扫描上万甚至几十万的主机。此外，一些特定的扫描选项会明显增 加扫描时间，如UDP扫描和版本检测。同样，防火墙配置以及特殊的响应速度限制也会 增加时间。Nmap使用了并行算法和许多先进的算法来加速扫描，用户对Nmap如何 工作有最终的控制权。高级用户可以仔细地调整Nmap命令，在满足时间要求的同时获得他们所关心的信息。</p>
<h3 id="min-hostgroup-lt-size-gt-max-hostgroup-lt-size-gt-调整并行扫描组的大小"><a href="#min-hostgroup-lt-size-gt-max-hostgroup-lt-size-gt-调整并行扫描组的大小" class="headerlink" title="--min-hostgroup &lt;size&gt;; --max-hostgroup &lt;size&gt; (调整并行扫描组的大小)"></a><code>--min-hostgroup &lt;size&gt;</code>; <code>--max-hostgroup &lt;size&gt;</code> (调整并行扫描组的大小)</h3><p>Nmap具有并行扫描多主机端口或版本的能力，Nmap将多个目标IP地址 空间分成组，然后在同一时间对一个组进行扫描。通常，大的组更有效。缺 点是只有当整个组扫描结束后才会提供主机的扫描结果。如果组的大小定义 为50，则只有当前50个主机扫描结束后才能得到报告(详细模式中的补充信息 除外)。</p>
<p>默认方式下，Nmap采取折衷的方法。开始扫描时的组较小， 最小为5，这样便于尽快产生结果；随后增长组的大小，最大为1024。确切的 大小依赖于所给定的选项。为保证效率，针对UDP或少量端口的TCP扫描，Nmap 使用大的组。</p>
<p><code>--max-hostgroup</code>选项用于说明使用最大的组，Nmap不 会超出这个大小。<code>--min-hostgroup</code>选项说明最小的组，Nmap 会保持组大于这个值。如果在指定的接口上没有足够的目标主机来满足所 指定的最小值，Nmap可能会采用比所指定的值小的组。这两个参数虽然很少使用， 但都用于保持组的大小在一个指定的范围之内。</p>
<p>这些选项的主要用途是说明一个最小组的大小，使得整个扫描更加快速。通常 选择256来扫描C类网段。对于端口数较多的扫描，超出该值没有意义。对于 端口数较少的扫描，2048或更大的组大小是有帮助的。</p>
<h3 id="min-parallelism-lt-numprobes-gt-max-parallelism-lt-numprobes-gt-调整探测报文的并行度"><a href="#min-parallelism-lt-numprobes-gt-max-parallelism-lt-numprobes-gt-调整探测报文的并行度" class="headerlink" title="--min-parallelism &lt;numprobes&gt;; --max-parallelism &lt;numprobes&gt; (调整探测报文的并行度)"></a><code>--min-parallelism &lt;numprobes&gt;</code>; <code>--max-parallelism &lt;numprobes&gt;</code> (调整探测报文的并行度)</h3><p>这些选项控制用于主机组的探测报文数量，可用于端口扫描和主机发现。默认状态下， Nmap基于网络性能计算一个理想的并行度，这个值经常改变。如果报文被丢弃， Nmap降低速度，探测报文数量减少。随着网络性能的改善，理想的探测报文数量会缓慢增加。 这些选项确定这个变量的大小范围。默认状态下，当网络不可靠时，理想的并行度值 可能为1，在好的条件下，可能会增长至几百。</p>
<p>最常见的应用是<code>--min-parallelism</code>值大于1，以加快 性能不佳的主机或网络的扫描。这个选项具有风险，如果过高则影响准确度，同时 也会降低Nmap基于网络条件动态控制并行度的能力。这个值设为10较为合适， 这个值的调整往往作为最后的手段。</p>
<p><code>--max-parallelism</code>选项通常设为1，以防止Nmap在同一时间 向主机发送多个探测报文，和选择<code>--scan-delay</code>同时使用非常有用，虽然 这个选项本身的用途已经很好。</p>
<h3 id="min-rtt-timeout-lt-milliseconds-gt-，-max-rtt-timeout-lt-milliseconds-gt-，-initial-rtt-timeout-lt-milliseconds-gt-调整探测报文超时"><a href="#min-rtt-timeout-lt-milliseconds-gt-，-max-rtt-timeout-lt-milliseconds-gt-，-initial-rtt-timeout-lt-milliseconds-gt-调整探测报文超时" class="headerlink" title="--min-rtt-timeout &lt;milliseconds&gt;， --max-rtt-timeout &lt;milliseconds&gt;， --initial-rtt-timeout &lt;milliseconds&gt; (调整探测报文超时)"></a><code>--min-rtt-timeout &lt;milliseconds&gt;</code>， <code>--max-rtt-timeout &lt;milliseconds&gt;</code>， <code>--initial-rtt-timeout &lt;milliseconds&gt;</code> (调整探测报文超时)</h3><p>Nmap使用一个运行超时值来确定等待探测报文响应的时间，随后会放弃或重新 发送探测报文。Nmap基于上一个探测报文的响应时间来计算超时值，如果网络延迟比较显著 和不定，这个超时值会增加几秒。初始值的比较保守(高)，而当Nmap扫描无响应 的主机时，这个保守值会保持一段时间。</p>
<p>这些选项以毫秒为单位，采用小的<code>--max-rtt-timeout</code>值，使 <code>--initial-rtt-timeout</code>值大于默认值可以明显减少扫描时间，特别 是对不能ping通的扫描(<code>-P0</code>)以及具有严格过滤的网络。如果使用太 小的值，使得很多探测报文超时从而重新发送，而此时可能响应消息正在发送，这使得整个扫描的时 间会增加。</p>
<p>如果所有的主机都在本地网络，对于<code>--max-rtt-timeout</code>值来 说，100毫秒比较合适。如果存在路由，首先使用ICMP ping工具ping主机，或使用其 它报文工具如hpings，可以更好地穿透防火墙。查看大约10个包的最大往返时间，然后将 <code>--initial-rtt-timeout</code>设成这个时间的2倍，<code>--max-rtt-timeout</code> 可设成这个时间值的3倍或4倍。通常，不管ping的时间是多少，最大的rtt值不得小于100ms， 不能超过1000ms。</p>
<p><code>--min-rtt-timeout</code>这个选项很少使用，当网络不可靠时， Nmap的默认值也显得过于强烈，这时这个选项可起作用。当网络看起来不可靠时，Nmap仅将 超时时间降至最小值，这个情况是不正常的，需要向nmap-dev邮件列表报告bug。</p>
<h3 id="host-timeout-lt-milliseconds-gt-放弃低速目标主机"><a href="#host-timeout-lt-milliseconds-gt-放弃低速目标主机" class="headerlink" title="--host-timeout &lt;milliseconds&gt; (放弃低速目标主机)"></a><code>--host-timeout &lt;milliseconds&gt;</code> (放弃低速目标主机)</h3><p>由于性能较差或不可靠的网络硬件或软件、带宽限制、严格的防火墙等原因， 一些主机需要<em>很长</em>的时间扫描。这些极少数的主机扫描往往占 据了大部分的扫描时间。因此，最好的办法是减少时间消耗并且忽略这些主机，使用 <code>--host-timeout</code>选项来说明等待的时间(毫秒)。通常使用1800000 来保证Nmap不会在单个主机上使用超过半小时的时间。需要注意的是，Nmap在这半小时中可以 同时扫描其它主机，因此并不是完全放弃扫描。超时的主机被忽略，因此也没有针对该主机的 端口表、操作系统检测或版本检测结果的输出。</p>
<h3 id="scan-delay-lt-milliseconds-gt-max-scan-delay-lt-milliseconds-gt-调整探测报文的时间间隔"><a href="#scan-delay-lt-milliseconds-gt-max-scan-delay-lt-milliseconds-gt-调整探测报文的时间间隔" class="headerlink" title="--scan-delay &lt;milliseconds&gt;; --max-scan-delay &lt;milliseconds&gt; (调整探测报文的时间间隔)"></a><code>--scan-delay &lt;milliseconds&gt;</code>; <code>--max-scan-delay &lt;milliseconds&gt;</code> (调整探测报文的时间间隔)</h3><p>这个选项用于Nmap控制针对一个主机发送探测报文的等待时间(毫秒)，在带宽 控制的情况下这个选项非常有效。Solaris主机在响应UDP扫描探测报文报文时，每秒 只发送一个ICMP消息，因此Nmap发送的很多数探测报文是浪费的。<code>--scan-delay</code> 设为1000，使Nmap低速运行。Nmap尝试检测带宽控制并相应地调整扫描的延迟，但 并不影响明确说明何种速度工作最佳。</p>
<p><code>--scan-delay</code>的另一个用途是躲闭基于阈值的入侵检测和预防 系统(IDS/IPS)。</p>
<h3 id="T-lt-Paranoid-Sneaky-Polite-Normal-Aggressive-Insane-gt-设置时间模板"><a href="#T-lt-Paranoid-Sneaky-Polite-Normal-Aggressive-Insane-gt-设置时间模板" class="headerlink" title="-T &lt;Paranoid|Sneaky|Polite|Normal|Aggressive|Insane&gt; (设置时间模板)"></a><code>-T &lt;Paranoid|Sneaky|Polite|Normal|Aggressive|Insane&gt;</code> (设置时间模板)</h3><p>上述优化时间控制选项的功能很强大也很有效，但有些用户会被迷惑。此外， 往往选择合适参数的时间超过了所需优化的扫描时间。因此，Nmap提供了一些简单的 方法，使用6个时间模板，使用时采用<code>-T</code>选项及数字(0 - 5) 或名称。模板名称有paranoid (0)、sneaky (1)、polite (2)、normal(3)、 aggressive (4)和insane (5)。前两种模式用于IDS躲避，Polite模式降低了扫描 速度以使用更少的带宽和目标主机资源。默认模式为Normal，因此<code>-T3</code> 实际上是未做任何优化。Aggressive模式假设用户具有合适及可靠的网络从而加速 扫描。Insane模式假设用户具有特别快的网络或者愿意为获得速度而牺牲准确性。</p>
<p>用户可以根据自己的需要选择不同的模板，由Nmap负责选择实际的时间值。 模板也会针对其它的优化控制选项进行速度微调。例如，<code>-T4</code> 针对TCP端口禁止动态扫描延迟超过10ms，<code>-T5</code>对应的值为5ms。 模板可以和优化调整控制选项组合使用，但模板必须首先指定，否则模板的标准值 会覆盖用户指定的值。建议在扫描可靠的网络时使用 <code>-T4</code>，即使 在自己要增加优化控制选项时也使用(在命令行的开始)，从而从这些额外的较小的优化 中获益。</p>
<p>如果用于有足够的带宽或以太网连接，仍然建议使用<code>-T4</code>选项。 有些用户喜欢<code>-T5</code>选项，但这个过于强烈。有时用户考虑到避免使主机 崩溃或者希望更礼貌一些会采用<code>-T2</code>选项。他们并没意识到<code>-T Polite</code>选项是如何的慢，这种模式的扫描比默认方式实际上要多花10倍的时间。默认时间 选项(<code>-T3</code>)很少有主机崩溃和带宽问题，比较适合于谨慎的用户。不进行 版本检测比进行时间调整能更有效地解决这些问题。</p>
<p>虽然<code>-T0</code>和<code>-T1</code>选项可能有助于避免IDS告警，但 在进行上千个主机或端口扫描时，会显著增加时间。对于这种长时间的扫描，宁可设定确切的时间 值，而不要去依赖封装的<code>-T0</code>和<code>-T1</code>选项。</p>
<p><code>T0</code>选项的主要影响是对于连续扫描，在一个时间只能扫描一个端口， 每个探测报文的发送间隔为5分钟。<code>T1</code>和<code>T2</code>选项比较类似， 探测报文间隔分别为15秒和0.4秒。<code>T3</code>是Nmap的默认选项，包含了并行扫描。 <code>T4</code>选项与 <code>--max-rtt-timeout 1250 --initial-rtt-timeout 500</code> 等价，最大TCP扫描延迟为10ms。<code>T5</code>等价于 <code>--max-rtt-timeout 300 --min-rtt-timeout 50 --initial-rtt-timeout 250 --host-timeout 900000</code>，最大TCP扫描延迟为5ms。</p>
<hr>
<h2 id="防火墙-IDS躲避和哄骗"><a href="#防火墙-IDS躲避和哄骗" class="headerlink" title="防火墙/IDS躲避和哄骗"></a>防火墙/IDS躲避和哄骗</h2><h3 id="f-报文分段-mtu-使用指定的MTU"><a href="#f-报文分段-mtu-使用指定的MTU" class="headerlink" title="-f (报文分段); --mtu (使用指定的MTU)"></a><code>-f</code> (报文分段); <code>--mtu</code> (使用指定的MTU)</h3><p><code>-f</code>选项要求扫描时(包挺ping扫描)使用 小的IP包分段。其思路是将TCP头分段在几个包中，使得包过滤器、 IDS以及其它工具的检测更加困难。必须小心使用这个选项，有些系 统在处理这些小包时存在问题，例如旧的网络嗅探器Sniffit在接收 到第一个分段时会立刻出现分段错误。该选项使用一次，Nmap在IP 头后将包分成8个字节或更小。因此，一个20字节的TCP头会被分成3个 包，其中2个包分别有TCP头的8个字节，另1个包有TCP头的剩下4个字 节。当然，每个包都有一个IP头。再次使用<code>-f</code>可使用 16字节的分段(减少分段数量)。使用<code>--mtu</code>选项可 以自定义偏移的大小，使用时不需要<code>-f</code>，偏移量必须 是8的倍数。包过滤器和防火墙对所有的IP分段排队，如Linux核心中的 CONFIG-IP-ALWAYS-DEFRAG配置项，分段包不会直接使用。一些网络无法 承受这样所带来的性能冲击，会将这个配置禁止。其它禁止的原因有分段 包会通过不同的路由进入网络。一些源系统在内核中对发送的报文进行 分段，使用iptables连接跟踪模块的Linux就是一个例子。当使用类似Ethereal 的嗅探器时，扫描必须保证发送的报文要分段。如果主机操作系统会产 生问题，尝试使用<code>--send-eth</code>选项以避开IP层而直接 发送原始的以太网帧。</p>
<h3 id="D-lt-decoy1-，decoy2-，ME-，-gt-使用诱饵隐蔽扫描"><a href="#D-lt-decoy1-，decoy2-，ME-，-gt-使用诱饵隐蔽扫描" class="headerlink" title="-D &lt;decoy1 [，decoy2][，ME]，...&gt; (使用诱饵隐蔽扫描)"></a><code>-D &lt;decoy1 [，decoy2][，ME]，...&gt;</code> (使用诱饵隐蔽扫描)</h3><p>为使诱饵扫描起作用，需要使远程主机认为是诱饵在扫描目标网络。 IDS可能会报个某个IP的5-10个端口扫描，但并不知道哪个IP在扫描以及 哪些不是诱饵。但这种方式可以通过路由跟踪、响应丢弃以及其它主动 机制在解决。这是一种常用的隐藏自身IP地址的有效技术。</p>
<p>使用逗号分隔每个诱饵主机，也可用自己的真实IP作为诱饵，这时可使用 <code>ME</code>选项说明。如果在第6个位置或 更后的位置使用<code>ME</code>选项，一些常用 端口扫描检测器(如Solar Designer’s excellent scanlogd)就不会报告 这个真实IP。如果不使用<code>ME</code>选项，Nmap 将真实IP放在一个随机的位置</p>
<p>注意，作为诱饵的主机须在工作状态，否则会导致目标主机的SYN洪水攻击。 如果在网络中只有一个主机在工作，那就很容易确定哪个主机在扫描。也可 使用IP地址代替主机名(被诱骗的网络就不可能在名字服务器日志中发现)。</p>
<p>诱饵可用在初始的ping扫描(ICMP、SYN、ACK等)阶段或真正的端口扫描 阶段。诱饵也可以用于远程操作系统检测(<code>-O</code>)。在进行版 本检测或TCP连接扫描时，诱饵无效。</p>
<p>使用过多的诱饵没有任何价值，反而导致扫描变慢并且结果不准确。 此外，一些ISP会过滤哄骗的报文，但很多对欺骗IP包没有任何限制。</p>
<h3 id="S-lt-IP-Address-gt-源地址哄骗"><a href="#S-lt-IP-Address-gt-源地址哄骗" class="headerlink" title="-S &lt;IP_Address&gt; (源地址哄骗)"></a><code>-S &lt;IP_Address&gt;</code> (源地址哄骗)</h3><p>在某些情况下，Nmap可能无法确定你的源地址(如果这样，Nmap会给出 提示)。此时，使用<code>-S</code>选项并说明所需发送包的接口IP地址。</p>
<p>这个标志的另一个用处是哄骗性的扫描，使得目标认为是<em>另 一个地址</em>在进行扫描。可以想象某一个竞争对手在不断扫描某个公司！ <code>-e</code>选项常在这种情况下使用，也可采用<code>-P0</code>选项。</p>
<h3 id="e-lt-interface-gt-使用指定的接口"><a href="#e-lt-interface-gt-使用指定的接口" class="headerlink" title="-e &lt;interface&gt; (使用指定的接口)"></a><code>-e &lt;interface&gt;</code> (使用指定的接口)</h3><p>告诉Nmap使用哪个接口发送和接收报文，Nmap可以进行自动检测， 如果检测不出会给出提示。</p>
<h3 id="source-port-lt-portnumber-gt-g-lt-portnumber-gt-源端口哄骗"><a href="#source-port-lt-portnumber-gt-g-lt-portnumber-gt-源端口哄骗" class="headerlink" title="--source-port &lt;portnumber&gt;; -g &lt;portnumber&gt; (源端口哄骗)"></a><code>--source-port &lt;portnumber&gt;;</code> <code>-g &lt;portnumber&gt;</code> (源端口哄骗)</h3><p>仅依赖于源端口号就信任数据流是一种常见的错误配置，这个问题非常 好理解。例如一个管理员部署了一个新的防火墙，但招来了很多用户的不满，因为 他们的应用停止工作了。可能是由于外部的UDP DNS服务器响应无法进入网络，而导致 DNS的崩溃。FTP是另一个常见的例子，在FTP传输时，远程服务器尝试和内部用 建立连接以传输数据。</p>
<p>对这些问题有安全解决方案，通常是应用级代理或协议分析防火墙模块。 但也存在一些不安全的方案。注意到DNS响应来自于53端口，FTP连接 来自于20端口，很多管理员会掉入一个陷阱，即允许来自于这些端口的数据进入 网络。他们认为这些端口里不会有值得注意的攻击和漏洞利用。此外，管理员 或许认为这是一个短期的措施，直至他们采取更安全的方案。但他们忽视了安全的 升级。</p>
<p>不仅仅是工作量过多的网络管理员掉入这种陷阱，很多产品本身也会有这类 不安全的隐患，甚至是微软的产品。Windows 2000和Windows XP中包含的IPsec过滤 器也包含了一些隐含规则，允许所有来自88端口(Kerberos)的TCP和UDP数据流。另 一个常见的例子是Zone Alarm个人防火墙到2.1.25版本仍然允许源端口53(DNS)或 67(DHCP)的UDP包进入。</p>
<p>Nmap提供了<code>-g</code>和<code>--source-port</code>选项(它们是 等价的)，用于利用上述弱点。只需要提供一个端口号，Nmap就可以从这些 端口发送数据。为使特定的操作系统正常工作，Nmap必须使用不同的端口号。 DNS请求会忽略<code>--source-port</code>选项，这是因为Nmap依靠系 统库来处理。大部分TCP扫描，包括SYN扫描，可以完全支持这些选项，UDP扫 描同样如此。</p>
<h3 id="data-length-lt-number-gt-发送报文时-附加随机数据"><a href="#data-length-lt-number-gt-发送报文时-附加随机数据" class="headerlink" title="--data-length &lt;number&gt; (发送报文时 附加随机数据)"></a><code>--data-length &lt;number&gt;</code> (发送报文时 附加随机数据)</h3><p>正常情况下，Nmap发送最少的报文，只含一个包头。因此TCP包通常 是40字节，ICMP ECHO请求只有28字节。这个选项告诉Nmap在发送的报文上 附加指定数量的随机字节。操作系统检测(<code>-O</code>)包不受影响， 但大部分ping和端口扫描包受影响，这会使处理变慢，但对扫描的影响较小。</p>
<h3 id="ttl-lt-value-gt-设置IP-time-to-live域"><a href="#ttl-lt-value-gt-设置IP-time-to-live域" class="headerlink" title="--ttl &lt;value&gt; (设置IP time-to-live域)"></a><code>--ttl &lt;value&gt;</code> (设置IP time-to-live域)</h3><p>设置IPv4报文的time-to-live域为指定的值。</p>
<h3 id="randomize-hosts-对目标主机的顺序随机排列"><a href="#randomize-hosts-对目标主机的顺序随机排列" class="headerlink" title="--randomize-hosts (对目标主机的顺序随机排列)"></a><code>--randomize-hosts</code> (对目标主机的顺序随机排列)</h3><p>告诉Nmap在扫描主机前对每个组中的主机随机排列，最多可达 8096个主机。这会使得扫描针对不同的网络监控系统来说变得不是很 明显，特别是配合值较小的时间选项时更有效。如果需要对一个较大 的组进行随机排列，需要增大<code>nmap.h</code>文件中 PING-GROUP-SZ的值，并重新编译。另一种方法是使用列表扫描 (<code>-sL -n -oN *</code><filename><code>*</code>)，产生目标IP的列表， 使用Perl脚本进行随机化，然后使用<code>-iL</code>提供给Nmap。</p>
<h3 id="spoof-mac-lt-mac-address，prefix，or-vendor-name-gt-MAC地址哄骗"><a href="#spoof-mac-lt-mac-address，prefix，or-vendor-name-gt-MAC地址哄骗" class="headerlink" title="--spoof-mac &lt;mac address，prefix，or vendor name&gt; (MAC地址哄骗)"></a><code>--spoof-mac &lt;mac address，prefix，or vendor name&gt;</code> (MAC地址哄骗)</h3><p>要求Nmap在发送原以太网帧时使用指定的MAC地址，这个选项隐含了 <code>--send-eth</code>选项，以保证Nmap真正发送以太网包。MAC地址有几 种格式。如果简单地使用字符串“0”，Nmap选择一个完全随机的MAC 地址。如果给定的字符品是一个16进制偶数(使用:分隔)，Nmap将使用这个MAC地址。 如果是小于12的16进制数字，Nmap会随机填充剩下的6个字节。如果参数不是0或16进 制字符串，Nmap将通过<code>nmap-mac-prefixes</code>查找 厂商的名称(大小写区分)，如果找到匹配，Nmap将使用厂商的OUI(3字节前缀)，然后 随机填充剩余的3个节字。正确的<code>--spoof-mac</code>参数有， <code>Apple</code>， <code>0</code>，<code>01:02:03:04:05:06</code>， <code>deadbeefcafe</code>，<code>0020F2</code>， 和<code>Cisco</code>.</p>
<hr>
<h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h2><h3 id="oN-lt-filespec-gt-标准输出"><a href="#oN-lt-filespec-gt-标准输出" class="headerlink" title="-oN &lt;filespec&gt; (标准输出)"></a><code>-oN &lt;filespec&gt;</code> (标准输出)</h3><h3 id="oX-lt-filespec-gt-XML输出"><a href="#oX-lt-filespec-gt-XML输出" class="headerlink" title="-oX &lt;filespec&gt; (XML输出)"></a><code>-oX &lt;filespec&gt;</code> (XML输出)</h3><h3 id="oS-lt-filespec-gt-ScRipT-KIdd-3-oUTpuT"><a href="#oS-lt-filespec-gt-ScRipT-KIdd-3-oUTpuT" class="headerlink" title="-oS &lt;filespec&gt; (ScRipT KIdd|3 oUTpuT)"></a><code>-oS &lt;filespec&gt;</code> (ScRipT KIdd|3 oUTpuT)</h3><h3 id="oG-lt-filespec-gt-Grep输出"><a href="#oG-lt-filespec-gt-Grep输出" class="headerlink" title="-oG &lt;filespec&gt; (Grep输出)"></a><code>-oG &lt;filespec&gt;</code> (Grep输出)</h3><h3 id="oA-lt-basename-gt-输出至所有格式"><a href="#oA-lt-basename-gt-输出至所有格式" class="headerlink" title="-oA &lt;basename&gt; (输出至所有格式)"></a><code>-oA &lt;basename&gt;</code> (输出至所有格式)</h3><h3 id="v-提高输出信息的详细度"><a href="#v-提高输出信息的详细度" class="headerlink" title="-v (提高输出信息的详细度)"></a><code>-v</code> (提高输出信息的详细度)</h3><h3 id="d-level-提高或设置调试级别"><a href="#d-level-提高或设置调试级别" class="headerlink" title="-d [level] (提高或设置调试级别)"></a><code>-d [level]</code> (提高或设置调试级别)</h3><h3 id="packet-trace-跟踪发送和接收的报文"><a href="#packet-trace-跟踪发送和接收的报文" class="headerlink" title="--packet-trace (跟踪发送和接收的报文)"></a><code>--packet-trace</code> (跟踪发送和接收的报文)</h3><h3 id="iflist-列举接口和路由"><a href="#iflist-列举接口和路由" class="headerlink" title="--iflist (列举接口和路由)"></a><code>--iflist</code> (列举接口和路由)</h3><h3 id="append-output-在输出文件中添加"><a href="#append-output-在输出文件中添加" class="headerlink" title="--append-output (在输出文件中添加)"></a><code>--append-output</code> (在输出文件中添加)</h3><h3 id="resume-lt-filename-gt-继续中断的扫描"><a href="#resume-lt-filename-gt-继续中断的扫描" class="headerlink" title="--resume &lt;filename&gt; (继续中断的扫描)"></a><code>--resume &lt;filename&gt;</code> (继续中断的扫描)</h3><h3 id="stylesheet-lt-path-or-URL-gt-设置XSL样式表，转换XML输出"><a href="#stylesheet-lt-path-or-URL-gt-设置XSL样式表，转换XML输出" class="headerlink" title="--stylesheet &lt;path or URL&gt; (设置XSL样式表，转换XML输出)"></a><code>--stylesheet &lt;path or URL&gt;</code> (设置XSL样式表，转换XML输出)</h3><h3 id="no-stylesheet-忽略XML声明的XSL样式表"><a href="#no-stylesheet-忽略XML声明的XSL样式表" class="headerlink" title="--no-stylesheet (忽略XML声明的XSL样式表)"></a><code>--no-stylesheet</code> (忽略XML声明的XSL样式表)</h3><hr>
<h2 id="其它选项"><a href="#其它选项" class="headerlink" title="其它选项"></a>其它选项</h2><h3 id="6-启用IPv6扫描"><a href="#6-启用IPv6扫描" class="headerlink" title="-6 (启用IPv6扫描)"></a><code>-6</code> (启用IPv6扫描)</h3><p>从2002年起，Nmap提供对IPv6的一些主要特征的支持。ping扫描(TCP-only)、 连接扫描以及版本检测都支持IPv6。除增加<code>-6</code>选项外， 其它命令语法相同。当然，必须使用IPv6地址来替换主机名，如 <code>3ffe:7501:4819:2000:210:f3ff:fe03:14d0</code>。 除“所关注的端口”行的地址部分为IPv6地址。</p>
<p>IPv6目前未在全球广泛采用，目前在一些国家(亚洲)应用较多， 一些高级操作系统支持IPv6。使用Nmap的IPv6功能，扫描的源和目 的都需要配置IPv6。如果ISP(大部分)不分配IPv6地址，Nmap可以采用 免费的隧道代理。一种较好的选择是BT Exact，位于<a target="_blank" rel="noopener" href="https://tb.ipv6.btexact.com/"><code>https://tb.ipv6.btexact.com/</code></a>。 此外，还有Hurricane Electric，位于<a target="_blank" rel="noopener" href="http://ipv6tb.he.net/"><code>http://ipv6tb.he.net/</code></a>。6to4隧道是 另一种常用的免费方法。</p>
<h3 id="A-激烈扫描模式选项"><a href="#A-激烈扫描模式选项" class="headerlink" title="-A (激烈扫描模式选项)"></a><code>-A</code> (激烈扫描模式选项)</h3><p>这个选项启用额外的高级和高强度选项，目前还未确定代表 的内容。目前，这个选项启用了操作系统检测(<code>-O</code>) 和版本扫描(<code>-sV</code>)，以后会增加更多的功能。 目的是启用一个全面的扫描选项集合，不需要用户记忆大量的 选项。这个选项仅仅启用功能，不包含用于可能所需要的 时间选项(如<code>-T4</code>)或细节选项(<code>-v</code>)。</p>
<h3 id="datadir-lt-directoryname-gt-说明用户Nmap数据文件位置"><a href="#datadir-lt-directoryname-gt-说明用户Nmap数据文件位置" class="headerlink" title="--datadir &lt;directoryname&gt; (说明用户Nmap数据文件位置)"></a><code>--datadir &lt;directoryname&gt;</code> (说明用户Nmap数据文件位置)</h3><p>Nmap在运行时从文件中获得特殊的数据，这些文件有 <code>nmap-service-probes</code>， <code>nmap-services</code>， <code>nmap-protocols</code>， <code>nmap-rpc</code>， <code>nmap-mac-prefixes</code>和 <code>nmap-os-fingerprints</code>。Nmap首先 在<code>--datadir</code>选项说明的目录中查找这些文件。 未找到的文件，将在BMAPDIR环境变量说明的目录中查找。 接下来是用于真正和有效UID的<code>~/.nmap</code> 或Nmap可执行代码的位置(仅Win32)；然后是是编译位置， 如<code>/usr/local/share/nmap</code> 或<code>/usr/share/nmap</code>。 Nmap查找的最后一个位置是当前目录。</p>
<h3 id="send-eth-使用原以太网帧发送"><a href="#send-eth-使用原以太网帧发送" class="headerlink" title="--send-eth (使用原以太网帧发送)"></a><code>--send-eth</code> (使用原以太网帧发送)</h3><p>要求Nmap在以太网(数据链路)层而不是IP(网络层)发送 报文。默认方式下，Nmap选择最适合其运行平台的方式，原套接 字(IP层)是UNIX主机最有效的方式，而以太网帧最适合Windows操作 系统，因为Microsoft禁用了原套接字支持。在UNIX中，如果没有其 它选择(如无以太网连接)，不管是否有该选项，Nmap都使用原IP包。</p>
<h3 id="send-ip-在原IP层发送"><a href="#send-ip-在原IP层发送" class="headerlink" title="--send-ip (在原IP层发送)"></a><code>--send-ip</code> (在原IP层发送)</h3><p>要求Nmap通过原IP套接字发送报文，而不是低层的以 太网帧。这是<code>--send-eth</code>选项的补充。</p>
<h3 id="privileged-假定用户具有全部权限"><a href="#privileged-假定用户具有全部权限" class="headerlink" title="--privileged (假定用户具有全部权限)"></a><code>--privileged</code> (假定用户具有全部权限)</h3><p>告诉Nmap假定其具有足够的权限进行源套接字包发送、 报文捕获和类似UNIX系统中根用户操作的权限。默认状态下， 如果由getuid()请求的类似操作不为0，Nmap将退出。 <code>--privileged</code>在具有Linux内核性能的类似 系统中使用非常有效，这些系统配置允许非特权用户可以进行 原报文扫描。需要明确的是，在其它选项之前使用这些需要权 限的选项(SYN扫描、操作系统检测等)。Nmap-PRIVILEGED变量 设置等价于<code>--privileged</code>选项。</p>
<h3 id="V-version-打印版本信息"><a href="#V-version-打印版本信息" class="headerlink" title="-V; --version (打印版本信息)"></a><code>-V</code>; <code>--version</code> (打印版本信息)</h3><p>打印Nmap版本号并退出。</p>
<h3 id="h-help-打印帮助摘要面"><a href="#h-help-打印帮助摘要面" class="headerlink" title="-h; --help (打印帮助摘要面)"></a><code>-h</code>; <code>--help</code> (打印帮助摘要面)</h3><p>打印一个短的帮助屏幕，列出大部分常用的 命令选项，这个功能与不带参数运行Nmap是相同的。</p>
<h1 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -v scanme.nmap.org <span class="comment">#这个选项扫描主机scanme.nmap.org中 所有的保留TCP端口。选项-v启用细节模式。</span></span><br><span class="line">nmap -sS -O scanme.nmap.org/24 <span class="comment">#进行秘密SYN扫描，对象为主机Saznme所在的“C类”网段 的255台主机。同时尝试确定每台工作主机的操作系统类型。因为进行SYN扫描 和操作系统检测，这个扫描需要有根权限。</span></span><br><span class="line">nmap -sV -p 22，53，110，143，4564 198.116.0-255.1-127 <span class="comment">#进行主机列举和TCP扫描，对象为B类188.116网段中255个8位子网。这 个测试用于确定系统是否运行了sshd、DNS、imapd或4564端口。如果这些端口 打开，将使用版本检测来确定哪种应用在运行。</span></span><br><span class="line">nmap -v -iR 100000 -P0 -p 80 <span class="comment">#随机选择100000台主机扫描是否运行Web服务器(80端口)。由起始阶段 发送探测报文来确定主机是否工作非常浪费时间，而且只需探测主机的一个端口，因 此使用-P0禁止对主机列表。</span></span><br><span class="line">nmap -P0 -p80 -oX logs/pb-port80scan.xml -oG logs/pb-port80scan.gnmap 216.163.128.20/20 <span class="comment">#扫描4096个IP地址，查找Web服务器(不ping)，将结果以Grep和XML格式保存。</span></span><br><span class="line">host -l company.com | <span class="built_in">cut</span> -d -f 4 | nmap -v -iL - <span class="comment">#进行DNS区域传输，以发现company.com中的主机，然后将IP地址提供给 Nmap。上述命令用于GNU/Linux -- 其它系统进行区域传输时有不同的命令。</span></span><br></pre></td></tr></table></figure>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/tools/">tools</a><a class="post-meta__tags" href="/tags/nmap/">nmap</a></div><div class="post_share"><div class="social-share" data-image="/img/nmap/sitelogo.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/IMG_3401.jpg" target="_blank"><img class="post-qr-code-img" src="/img/IMG_3401.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/IMG_3402.jpg" target="_blank"><img class="post-qr-code-img" src="/img/IMG_3402.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/23fdc19fa5e0/"><img class="prev-cover" src="/img/cover/IMG_0161.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">中华人民共和国网络安全法</div></div></a></div><div class="next-post pull-right"><a href="/50b08707a5fb/"><img class="next-cover" src="/img/one_time_clean_win/1.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">帮朋友的豆芽查看电脑的问题的那些事</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/ccb0fd139dc8/" title="IDE和编辑器整理"><img class="cover" src="/img/cover/IMG_0164.JPG" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-17</div><div class="title">IDE和编辑器整理</div></div></a></div><div><a href="/79ad5a81e4e4/" title="逆向工具"><img class="cover" src="/img/cover/IMG_0170.JPG" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-16</div><div class="title">逆向工具</div></div></a></div><div><a href="/7068c8d0a220/" title="网络安全工具"><img class="cover" src="/img/cover/IMG_0162.JPG" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-15</div><div class="title">网络安全工具</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/29786999?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ZYmyShadow</div><div class="author-info__description">网安 ｜ 软工 ｜ 计科 ｜ 本科</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">15</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://space.bilibili.com/24746850"><i class="fab fa-bilibili"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ZYmyShadow" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:hzhazha16138@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/24746850" target="_blank" title="Bilibili"><i class="fab fa-bilibili"></i></a><a class="social-icon" href="https://zymyshadow.github.io/" target="_blank" title="Blog"><i class="fas fa-blog"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">别下次一定了，这次就三连叭，谢谢各位大帅比和大漂亮了</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NMAP%E5%AE%98%E6%96%B9%E5%B8%AE%E5%8A%A9%E8%AF%B4%E6%98%8E"><span class="toc-number">1.</span> <span class="toc-text">NMAP官方帮助说明</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NMAP%E5%B8%B8%E7%94%A8%E9%80%89%E9%A1%B9"><span class="toc-number">2.</span> <span class="toc-text">NMAP常用选项</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F%E5%AD%98%E6%B4%BB%E4%B8%BB%E6%9C%BA"><span class="toc-number">2.1.</span> <span class="toc-text">扫描存活主机</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NMAP%E9%80%89%E9%A1%B9%E8%A7%A3%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">NMAP选项解析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E8%AF%B4%E6%98%8E"><span class="toc-number">3.1.</span> <span class="toc-text">目标说明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#iL-lt-inputfilename-gt-%E4%BB%8E%E5%88%97%E8%A1%A8%E4%B8%AD%E8%BE%93%E5%85%A5"><span class="toc-number">3.1.1.</span> <span class="toc-text">-iL &lt;inputfilename&gt; (从列表中输入)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iR-lt-hostnum-gt-%E9%9A%8F%E6%9C%BA%E9%80%89%E6%8B%A9%E7%9B%AE%E6%A0%87"><span class="toc-number">3.1.2.</span> <span class="toc-text">-iR &lt;hostnum&gt; (随机选择目标)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exclude-lt-host1-%EF%BC%8Chost2-%EF%BC%8Chost3-%EF%BC%8C-gt-%E6%8E%92%E9%99%A4%E4%B8%BB%E6%9C%BA-%E7%BD%91%E7%BB%9C"><span class="toc-number">3.1.3.</span> <span class="toc-text">--exclude &lt;host1[，host2][，host3]，...&gt; (排除主机&#x2F;网络)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#excludefile-lt-excludefile-gt-%E6%8E%92%E9%99%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%88%97%E8%A1%A8"><span class="toc-number">3.1.4.</span> <span class="toc-text">--excludefile &lt;excludefile&gt; (排除文件中的列表)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0"><span class="toc-number">3.2.</span> <span class="toc-text">主机发现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sL-%E5%88%97%E8%A1%A8%E6%89%AB%E6%8F%8F"><span class="toc-number">3.2.1.</span> <span class="toc-text">-sL (列表扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sP-Ping%E6%89%AB%E6%8F%8F"><span class="toc-number">3.2.2.</span> <span class="toc-text">-sP (Ping扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P0-%E6%97%A0ping"><span class="toc-number">3.2.3.</span> <span class="toc-text">-P0 (无ping)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PS-portlist-TCP-SYN-Ping"><span class="toc-number">3.2.4.</span> <span class="toc-text">-PS [portlist] (TCP SYN Ping)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PA-portlist-TCP-ACK-Ping"><span class="toc-number">3.2.5.</span> <span class="toc-text">-PA [portlist] (TCP ACK Ping)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PU-portlist-UDP-Ping"><span class="toc-number">3.2.6.</span> <span class="toc-text">-PU [portlist] (UDP Ping)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PE-PP-PM-ICMP-Ping-Types"><span class="toc-number">3.2.7.</span> <span class="toc-text">-PE; -PP; -PM (ICMP Ping Types)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PR-ARP-Ping"><span class="toc-number">3.2.8.</span> <span class="toc-text">-PR (ARP Ping)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#n-%E4%B8%8D%E7%94%A8%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90"><span class="toc-number">3.2.9.</span> <span class="toc-text">-n (不用域名解析)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-%E4%B8%BA%E6%89%80%E6%9C%89%E7%9B%AE%E6%A0%87%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D"><span class="toc-number">3.2.10.</span> <span class="toc-text">-R (为所有目标解析域名)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#system-dns-%E4%BD%BF%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">3.2.11.</span> <span class="toc-text">--system-dns (使用系统域名解析器)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E5%9F%BA%E7%A1%80"><span class="toc-number">3.3.</span> <span class="toc-text">Nmap核心功能 - 端口扫描基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#open-%E5%BC%80%E6%94%BE%E7%9A%84"><span class="toc-number">3.3.1.</span> <span class="toc-text">open(开放的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#closed-%E5%85%B3%E9%97%AD%E7%9A%84"><span class="toc-number">3.3.2.</span> <span class="toc-text">closed(关闭的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#filtered-%E8%A2%AB%E8%BF%87%E6%BB%A4%E7%9A%84"><span class="toc-number">3.3.3.</span> <span class="toc-text">filtered(被过滤的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unfiltered-%E6%9C%AA%E8%A2%AB%E8%BF%87%E6%BB%A4%E7%9A%84"><span class="toc-number">3.3.4.</span> <span class="toc-text">unfiltered(未被过滤的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#open-filtered-%E5%BC%80%E6%94%BE%E6%88%96%E8%80%85%E8%A2%AB%E8%BF%87%E6%BB%A4%E7%9A%84"><span class="toc-number">3.3.5.</span> <span class="toc-text">open|filtered(开放或者被过滤的)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#closed-filtered-%E5%85%B3%E9%97%AD%E6%88%96%E8%80%85%E8%A2%AB%E8%BF%87%E6%BB%A4%E7%9A%84"><span class="toc-number">3.3.6.</span> <span class="toc-text">closed|filtered(关闭或者被过滤的)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E6%8A%80%E6%9C%AF"><span class="toc-number">3.4.</span> <span class="toc-text">端口扫描技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sS-TCP-SYN%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.1.</span> <span class="toc-text">-sS (TCP SYN扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sT-TCP-connect-%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.2.</span> <span class="toc-text">-sT (TCP connect()扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sU-UDP%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.3.</span> <span class="toc-text">-sU (UDP扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sN-sF-sX-TCP-Null%EF%BC%8CFIN%EF%BC%8Cand-Xmas%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.4.</span> <span class="toc-text">-sN; -sF; -sX (TCP Null，FIN，and Xmas扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sA-TCP-ACK%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.5.</span> <span class="toc-text">-sA (TCP ACK扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sW-TCP%E7%AA%97%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.6.</span> <span class="toc-text">-sW (TCP窗口扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sM-TCP-Maimon%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.7.</span> <span class="toc-text">-sM (TCP Maimon扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scanflags-%E5%AE%9A%E5%88%B6%E7%9A%84TCP%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.8.</span> <span class="toc-text">--scanflags (定制的TCP扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sI-lt-zombie-host-probeport-gt-Idlescan"><span class="toc-number">3.4.9.</span> <span class="toc-text">-sI &lt;zombie host[:probeport]&gt; (Idlescan)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sO-IP%E5%8D%8F%E8%AE%AE%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.10.</span> <span class="toc-text">-sO (IP协议扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b-lt-ftp-relay-host-gt-FTP%E5%BC%B9%E8%B7%B3%E6%89%AB%E6%8F%8F"><span class="toc-number">3.4.11.</span> <span class="toc-text">-b &lt;ftp relay host&gt; (FTP弹跳扫描)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%AF%E5%8F%A3%E8%AF%B4%E6%98%8E%E5%92%8C%E6%89%AB%E6%8F%8F%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.5.</span> <span class="toc-text">端口说明和扫描顺序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#p-lt-port-ranges-gt-%E5%8F%AA%E6%89%AB%E6%8F%8F%E6%8C%87%E5%AE%9A%E7%9A%84%E7%AB%AF%E5%8F%A3"><span class="toc-number">3.5.1.</span> <span class="toc-text">-p &lt;port ranges&gt; (只扫描指定的端口)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#F-%E5%BF%AB%E9%80%9F-%E6%9C%89%E9%99%90%E7%9A%84%E7%AB%AF%E5%8F%A3-%E6%89%AB%E6%8F%8F"><span class="toc-number">3.5.2.</span> <span class="toc-text">-F (快速 (有限的端口) 扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#r-%E4%B8%8D%E8%A6%81%E6%8C%89%E9%9A%8F%E6%9C%BA%E9%A1%BA%E5%BA%8F%E6%89%AB%E6%8F%8F%E7%AB%AF%E5%8F%A3"><span class="toc-number">3.5.3.</span> <span class="toc-text">-r (不要按随机顺序扫描端口)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%92%8C%E7%89%88%E6%9C%AC%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.6.</span> <span class="toc-text">服务和版本探测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sV-%E7%89%88%E6%9C%AC%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.6.1.</span> <span class="toc-text">-sV (版本探测)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#allports-%E4%B8%8D%E4%B8%BA%E7%89%88%E6%9C%AC%E6%8E%A2%E6%B5%8B%E6%8E%92%E9%99%A4%E4%BB%BB%E4%BD%95%E7%AB%AF%E5%8F%A3"><span class="toc-number">3.6.2.</span> <span class="toc-text">--allports (不为版本探测排除任何端口)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-intensity-lt-intensity-gt-%E8%AE%BE%E7%BD%AE-%E7%89%88%E6%9C%AC%E6%89%AB%E6%8F%8F%E5%BC%BA%E5%BA%A6"><span class="toc-number">3.6.3.</span> <span class="toc-text">--version-intensity &lt;intensity&gt; (设置 版本扫描强度)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-light-%E6%89%93%E5%BC%80%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.6.4.</span> <span class="toc-text">--version-light (打开轻量级模式)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-all-%E5%B0%9D%E8%AF%95%E6%AF%8F%E4%B8%AA%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.6.5.</span> <span class="toc-text">--version-all (尝试每个探测)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#version-trace-%E8%B7%9F%E8%B8%AA%E7%89%88%E6%9C%AC%E6%89%AB%E6%8F%8F%E6%B4%BB%E5%8A%A8"><span class="toc-number">3.6.6.</span> <span class="toc-text">--version-trace (跟踪版本扫描活动)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sR-RPC%E6%89%AB%E6%8F%8F"><span class="toc-number">3.6.7.</span> <span class="toc-text">-sR (RPC扫描)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.7.</span> <span class="toc-text">操作系统探测</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#O-%E5%90%AF%E7%94%A8%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B"><span class="toc-number">3.7.1.</span> <span class="toc-text">-O (启用操作系统检测)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#osscan-limit-%E9%92%88%E5%AF%B9%E6%8C%87%E5%AE%9A%E7%9A%84%E7%9B%AE%E6%A0%87%E8%BF%9B%E8%A1%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B"><span class="toc-number">3.7.2.</span> <span class="toc-text">--osscan-limit (针对指定的目标进行操作系统检测)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#osscan-guess-fuzzy-%E6%8E%A8%E6%B5%8B%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%B5%8B%E7%BB%93%E6%9E%9C"><span class="toc-number">3.7.3.</span> <span class="toc-text">--osscan-guess; --fuzzy (推测操作系统检测结果)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%92%8C%E6%80%A7%E8%83%BD"><span class="toc-number">3.8.</span> <span class="toc-text">时间和性能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#min-hostgroup-lt-size-gt-max-hostgroup-lt-size-gt-%E8%B0%83%E6%95%B4%E5%B9%B6%E8%A1%8C%E6%89%AB%E6%8F%8F%E7%BB%84%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">3.8.1.</span> <span class="toc-text">--min-hostgroup &lt;size&gt;; --max-hostgroup &lt;size&gt; (调整并行扫描组的大小)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#min-parallelism-lt-numprobes-gt-max-parallelism-lt-numprobes-gt-%E8%B0%83%E6%95%B4%E6%8E%A2%E6%B5%8B%E6%8A%A5%E6%96%87%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%BA%A6"><span class="toc-number">3.8.2.</span> <span class="toc-text">--min-parallelism &lt;numprobes&gt;; --max-parallelism &lt;numprobes&gt; (调整探测报文的并行度)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#min-rtt-timeout-lt-milliseconds-gt-%EF%BC%8C-max-rtt-timeout-lt-milliseconds-gt-%EF%BC%8C-initial-rtt-timeout-lt-milliseconds-gt-%E8%B0%83%E6%95%B4%E6%8E%A2%E6%B5%8B%E6%8A%A5%E6%96%87%E8%B6%85%E6%97%B6"><span class="toc-number">3.8.3.</span> <span class="toc-text">--min-rtt-timeout &lt;milliseconds&gt;， --max-rtt-timeout &lt;milliseconds&gt;， --initial-rtt-timeout &lt;milliseconds&gt; (调整探测报文超时)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#host-timeout-lt-milliseconds-gt-%E6%94%BE%E5%BC%83%E4%BD%8E%E9%80%9F%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA"><span class="toc-number">3.8.4.</span> <span class="toc-text">--host-timeout &lt;milliseconds&gt; (放弃低速目标主机)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#scan-delay-lt-milliseconds-gt-max-scan-delay-lt-milliseconds-gt-%E8%B0%83%E6%95%B4%E6%8E%A2%E6%B5%8B%E6%8A%A5%E6%96%87%E7%9A%84%E6%97%B6%E9%97%B4%E9%97%B4%E9%9A%94"><span class="toc-number">3.8.5.</span> <span class="toc-text">--scan-delay &lt;milliseconds&gt;; --max-scan-delay &lt;milliseconds&gt; (调整探测报文的时间间隔)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T-lt-Paranoid-Sneaky-Polite-Normal-Aggressive-Insane-gt-%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E6%A8%A1%E6%9D%BF"><span class="toc-number">3.8.6.</span> <span class="toc-text">-T &lt;Paranoid|Sneaky|Polite|Normal|Aggressive|Insane&gt; (设置时间模板)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99-IDS%E8%BA%B2%E9%81%BF%E5%92%8C%E5%93%84%E9%AA%97"><span class="toc-number">3.9.</span> <span class="toc-text">防火墙&#x2F;IDS躲避和哄骗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#f-%E6%8A%A5%E6%96%87%E5%88%86%E6%AE%B5-mtu-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84MTU"><span class="toc-number">3.9.1.</span> <span class="toc-text">-f (报文分段); --mtu (使用指定的MTU)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#D-lt-decoy1-%EF%BC%8Cdecoy2-%EF%BC%8CME-%EF%BC%8C-gt-%E4%BD%BF%E7%94%A8%E8%AF%B1%E9%A5%B5%E9%9A%90%E8%94%BD%E6%89%AB%E6%8F%8F"><span class="toc-number">3.9.2.</span> <span class="toc-text">-D &lt;decoy1 [，decoy2][，ME]，...&gt; (使用诱饵隐蔽扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#S-lt-IP-Address-gt-%E6%BA%90%E5%9C%B0%E5%9D%80%E5%93%84%E9%AA%97"><span class="toc-number">3.9.3.</span> <span class="toc-text">-S &lt;IP_Address&gt; (源地址哄骗)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#e-lt-interface-gt-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.9.4.</span> <span class="toc-text">-e &lt;interface&gt; (使用指定的接口)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#source-port-lt-portnumber-gt-g-lt-portnumber-gt-%E6%BA%90%E7%AB%AF%E5%8F%A3%E5%93%84%E9%AA%97"><span class="toc-number">3.9.5.</span> <span class="toc-text">--source-port &lt;portnumber&gt;; -g &lt;portnumber&gt; (源端口哄骗)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#data-length-lt-number-gt-%E5%8F%91%E9%80%81%E6%8A%A5%E6%96%87%E6%97%B6-%E9%99%84%E5%8A%A0%E9%9A%8F%E6%9C%BA%E6%95%B0%E6%8D%AE"><span class="toc-number">3.9.6.</span> <span class="toc-text">--data-length &lt;number&gt; (发送报文时 附加随机数据)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ttl-lt-value-gt-%E8%AE%BE%E7%BD%AEIP-time-to-live%E5%9F%9F"><span class="toc-number">3.9.7.</span> <span class="toc-text">--ttl &lt;value&gt; (设置IP time-to-live域)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#randomize-hosts-%E5%AF%B9%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA%E7%9A%84%E9%A1%BA%E5%BA%8F%E9%9A%8F%E6%9C%BA%E6%8E%92%E5%88%97"><span class="toc-number">3.9.8.</span> <span class="toc-text">--randomize-hosts (对目标主机的顺序随机排列)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#spoof-mac-lt-mac-address%EF%BC%8Cprefix%EF%BC%8Cor-vendor-name-gt-MAC%E5%9C%B0%E5%9D%80%E5%93%84%E9%AA%97"><span class="toc-number">3.9.9.</span> <span class="toc-text">--spoof-mac &lt;mac address，prefix，or vendor name&gt; (MAC地址哄骗)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%87%BA"><span class="toc-number">3.10.</span> <span class="toc-text">输出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#oN-lt-filespec-gt-%E6%A0%87%E5%87%86%E8%BE%93%E5%87%BA"><span class="toc-number">3.10.1.</span> <span class="toc-text">-oN &lt;filespec&gt; (标准输出)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oX-lt-filespec-gt-XML%E8%BE%93%E5%87%BA"><span class="toc-number">3.10.2.</span> <span class="toc-text">-oX &lt;filespec&gt; (XML输出)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oS-lt-filespec-gt-ScRipT-KIdd-3-oUTpuT"><span class="toc-number">3.10.3.</span> <span class="toc-text">-oS &lt;filespec&gt; (ScRipT KIdd|3 oUTpuT)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oG-lt-filespec-gt-Grep%E8%BE%93%E5%87%BA"><span class="toc-number">3.10.4.</span> <span class="toc-text">-oG &lt;filespec&gt; (Grep输出)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oA-lt-basename-gt-%E8%BE%93%E5%87%BA%E8%87%B3%E6%89%80%E6%9C%89%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.10.5.</span> <span class="toc-text">-oA &lt;basename&gt; (输出至所有格式)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#v-%E6%8F%90%E9%AB%98%E8%BE%93%E5%87%BA%E4%BF%A1%E6%81%AF%E7%9A%84%E8%AF%A6%E7%BB%86%E5%BA%A6"><span class="toc-number">3.10.6.</span> <span class="toc-text">-v (提高输出信息的详细度)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#d-level-%E6%8F%90%E9%AB%98%E6%88%96%E8%AE%BE%E7%BD%AE%E8%B0%83%E8%AF%95%E7%BA%A7%E5%88%AB"><span class="toc-number">3.10.7.</span> <span class="toc-text">-d [level] (提高或设置调试级别)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packet-trace-%E8%B7%9F%E8%B8%AA%E5%8F%91%E9%80%81%E5%92%8C%E6%8E%A5%E6%94%B6%E7%9A%84%E6%8A%A5%E6%96%87"><span class="toc-number">3.10.8.</span> <span class="toc-text">--packet-trace (跟踪发送和接收的报文)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iflist-%E5%88%97%E4%B8%BE%E6%8E%A5%E5%8F%A3%E5%92%8C%E8%B7%AF%E7%94%B1"><span class="toc-number">3.10.9.</span> <span class="toc-text">--iflist (列举接口和路由)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#append-output-%E5%9C%A8%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6%E4%B8%AD%E6%B7%BB%E5%8A%A0"><span class="toc-number">3.10.10.</span> <span class="toc-text">--append-output (在输出文件中添加)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resume-lt-filename-gt-%E7%BB%A7%E7%BB%AD%E4%B8%AD%E6%96%AD%E7%9A%84%E6%89%AB%E6%8F%8F"><span class="toc-number">3.10.11.</span> <span class="toc-text">--resume &lt;filename&gt; (继续中断的扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stylesheet-lt-path-or-URL-gt-%E8%AE%BE%E7%BD%AEXSL%E6%A0%B7%E5%BC%8F%E8%A1%A8%EF%BC%8C%E8%BD%AC%E6%8D%A2XML%E8%BE%93%E5%87%BA"><span class="toc-number">3.10.12.</span> <span class="toc-text">--stylesheet &lt;path or URL&gt; (设置XSL样式表，转换XML输出)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#no-stylesheet-%E5%BF%BD%E7%95%A5XML%E5%A3%B0%E6%98%8E%E7%9A%84XSL%E6%A0%B7%E5%BC%8F%E8%A1%A8"><span class="toc-number">3.10.13.</span> <span class="toc-text">--no-stylesheet (忽略XML声明的XSL样式表)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E9%80%89%E9%A1%B9"><span class="toc-number">3.11.</span> <span class="toc-text">其它选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%90%AF%E7%94%A8IPv6%E6%89%AB%E6%8F%8F"><span class="toc-number">3.11.1.</span> <span class="toc-text">-6 (启用IPv6扫描)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-%E6%BF%80%E7%83%88%E6%89%AB%E6%8F%8F%E6%A8%A1%E5%BC%8F%E9%80%89%E9%A1%B9"><span class="toc-number">3.11.2.</span> <span class="toc-text">-A (激烈扫描模式选项)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#datadir-lt-directoryname-gt-%E8%AF%B4%E6%98%8E%E7%94%A8%E6%88%B7Nmap%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E4%BD%8D%E7%BD%AE"><span class="toc-number">3.11.3.</span> <span class="toc-text">--datadir &lt;directoryname&gt; (说明用户Nmap数据文件位置)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#send-eth-%E4%BD%BF%E7%94%A8%E5%8E%9F%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%B8%A7%E5%8F%91%E9%80%81"><span class="toc-number">3.11.4.</span> <span class="toc-text">--send-eth (使用原以太网帧发送)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#send-ip-%E5%9C%A8%E5%8E%9FIP%E5%B1%82%E5%8F%91%E9%80%81"><span class="toc-number">3.11.5.</span> <span class="toc-text">--send-ip (在原IP层发送)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#privileged-%E5%81%87%E5%AE%9A%E7%94%A8%E6%88%B7%E5%85%B7%E6%9C%89%E5%85%A8%E9%83%A8%E6%9D%83%E9%99%90"><span class="toc-number">3.11.6.</span> <span class="toc-text">--privileged (假定用户具有全部权限)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#V-version-%E6%89%93%E5%8D%B0%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-number">3.11.7.</span> <span class="toc-text">-V; --version (打印版本信息)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#h-help-%E6%89%93%E5%8D%B0%E5%B8%AE%E5%8A%A9%E6%91%98%E8%A6%81%E9%9D%A2"><span class="toc-number">3.11.8.</span> <span class="toc-text">-h; --help (打印帮助摘要面)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.</span> <span class="toc-text">实例</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/5007921b20f7/" title="Springboot初始化框架整合（二）"><img src="/img/cover/IMG_0173.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Springboot初始化框架整合（二）"/></a><div class="content"><a class="title" href="/5007921b20f7/" title="Springboot初始化框架整合（二）">Springboot初始化框架整合（二）</a><time datetime="2022-11-19T08:25:01.000Z" title="发表于 2022-11-19 16:25:01">2022-11-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2573edcd0f47/" title="Springboot初始化框架整合（一）"><img src="/img/cover/IMG_0172.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Springboot初始化框架整合（一）"/></a><div class="content"><a class="title" href="/2573edcd0f47/" title="Springboot初始化框架整合（一）">Springboot初始化框架整合（一）</a><time datetime="2022-11-18T08:25:01.000Z" title="发表于 2022-11-18 16:25:01">2022-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/f95de5b81f55/" title="显示器推荐-购买指南"><img src="/img/cover/IMG_0166.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="显示器推荐-购买指南"/></a><div class="content"><a class="title" href="/f95de5b81f55/" title="显示器推荐-购买指南">显示器推荐-购买指南</a><time datetime="2022-10-23T08:16:09.000Z" title="发表于 2022-10-23 16:16:09">2022-10-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/46bdd9dc1ca8/" title="食品国家执行标准"><img src="/img/cover/IMG_0171.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="食品国家执行标准"/></a><div class="content"><a class="title" href="/46bdd9dc1ca8/" title="食品国家执行标准">食品国家执行标准</a><time datetime="2022-10-07T07:05:01.000Z" title="发表于 2022-10-07 15:05:01">2022-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2d4a5ff9e9e8/" title="信息收集流程"><img src="/img/cover/IMG_0168.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="信息收集流程"/></a><div class="content"><a class="title" href="/2d4a5ff9e9e8/" title="信息收集流程">信息收集流程</a><time datetime="2022-09-23T06:00:00.000Z" title="发表于 2022-09-23 14:00:00">2022-09-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/nmap/sitelogo.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By ZYmyShadow</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">欢迎来到修仙宗门！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://github-twikoo.vercel.app/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://github-twikoo.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="aplayer no-destroy" data-id="7403918909" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script data-pjax defer src="/js/custom/fixed_comment.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'b16a1fa0e63c46a4b8f28abfb06ae3fe';
  var gaud_map_key = 'e2b04289e870b005374ee030148d64fd&s=rsv3';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.0.5/lib/clock.min.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>